!function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function i(){return Object.create(null)}function a(e){e.forEach(n)}function o(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t}function c(e){return 0===Object.keys(e).length}const u="undefined"!=typeof window;let l=u?()=>window.performance.now():()=>Date.now(),h=u?e=>requestAnimationFrame(e):e;const d=new Set;function p(e){d.forEach((t=>{t.c(e)||(d.delete(t),t.f())})),0!==d.size&&h(p)}function f(e){let t;return 0===d.size&&h(p),{promise:new Promise((n=>{d.add(t={c:e,f:n})})),abort(){d.delete(t)}}}let m=!1;const v=new Set;function g(e,t){m&&v.delete(t),t.parentNode!==e&&e.appendChild(t)}function b(e,t,n){m&&v.delete(t),(t.parentNode!==e||n&&t.nextSibling!==n)&&e.insertBefore(t,n||null)}function S(e){m?v.add(e):e.parentNode&&e.parentNode.removeChild(e)}function y(e){return document.createElement(e)}function w(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function C(e){return document.createTextNode(e)}function k(){return C(" ")}function N(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function x(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function T(e,t,n){t in e?e[t]="boolean"==typeof e[t]&&""===n||n:x(e,t,n)}function A(e,t,n,i){e.style.setProperty(t,n,i?"important":"")}function _(e,t,n){e.classList[n?"add":"remove"](t)}function E(e){const t={};for(const n of e)t[n.name]=n.value;return t}const R=new Set;let I,M=0;function $(e,t,n,i,a,o,r,s=0){const c=16.666/i;let u="{\n";for(let e=0;e<=1;e+=c){const i=t+(n-t)*o(e);u+=100*e+`%{${r(i,1-i)}}\n`}const l=u+`100% {${r(n,1-n)}}\n}`,h=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(l)}_${s}`,d=e.ownerDocument;R.add(d);const p=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(y("style")).sheet),f=d.__svelte_rules||(d.__svelte_rules={});f[h]||(f[h]=!0,p.insertRule(`@keyframes ${h} ${l}`,p.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?`${m}, `:""}${h} ${i}ms linear ${a}ms 1 both`,M+=1,h}function O(e,t){const n=(e.style.animation||"").split(", "),i=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),a=n.length-i.length;a&&(e.style.animation=i.join(", "),M-=a,M||h((()=>{M||(R.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),R.clear())})))}function z(e){I=e}function B(){if(!I)throw new Error("Function called outside component initialization");return I}function P(e){B().$$.on_mount.push(e)}const L=[],F=[],D=[],W=[],j=Promise.resolve();let U=!1;function G(e){D.push(e)}let K=!1;const H=new Set;function V(){if(!K){K=!0;do{for(let e=0;e<L.length;e+=1){const t=L[e];z(t),J(t.$$)}for(z(null),L.length=0;F.length;)F.pop()();for(let e=0;e<D.length;e+=1){const t=D[e];H.has(t)||(H.add(t),t())}D.length=0}while(L.length);for(;W.length;)W.pop()();U=!1,K=!1,H.clear()}}function J(e){if(null!==e.fragment){e.update(),a(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(G)}}let Z;function q(){return Z||(Z=Promise.resolve(),Z.then((()=>{Z=null}))),Z}function X(e,t,n){e.dispatchEvent(function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(`${t?"intro":"outro"}${n}`))}const Y=new Set;let Q;function ee(e,t){e&&e.i&&(Y.delete(e),e.i(t))}function te(e,t,n,i){if(e&&e.o){if(Y.has(e))return;Y.add(e),Q.c.push((()=>{Y.delete(e),i&&(n&&e.d(1),i())})),e.o(t)}}const ne={duration:0};const ie="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function ae(e){e&&e.c()}function oe(e,t,i,r){const{fragment:s,on_mount:c,on_destroy:u,after_update:l}=e.$$;s&&s.m(t,i),r||G((()=>{const t=c.map(n).filter(o);u?u.push(...t):a(t),e.$$.on_mount=[]})),l.forEach(G)}function re(e,t){const n=e.$$;null!==n.fragment&&(a(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function se(e,t){-1===e.$$.dirty[0]&&(L.push(e),U||(U=!0,j.then(V)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ce(t,n,o,r,s,c,u=[-1]){const l=I;z(t);const h=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:s,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:n.context||[]),callbacks:i(),dirty:u,skip_bound:!1};let d=!1;if(h.ctx=o?o(t,n.props||{},((e,n,...i)=>{const a=i.length?i[0]:n;return h.ctx&&s(h.ctx[e],h.ctx[e]=a)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](a),d&&se(t,e)),n})):[],h.update(),d=!0,a(h.before_update),h.fragment=!!r&&r(h.ctx),n.target){if(n.hydrate){m=!0;const e=function(e){return Array.from(e.childNodes)}(n.target);h.fragment&&h.fragment.l(e),e.forEach(S)}else h.fragment&&h.fragment.c();n.intro&&ee(t.$$.fragment),oe(t,n.target,n.anchor,n.customElement),function(){m=!1;for(const e of v)e.parentNode.removeChild(e);v.clear()}(),V()}z(l)}let ue;"function"==typeof HTMLElement&&(ue=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(n).filter(o);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){a(this.$$.on_disconnect)}$destroy(){re(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!c(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});class le{$destroy(){re(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!c(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var he="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function de(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})})),t}function pe(e){var t={exports:{}};return e(t,t.exports),t.exports}var fe=pe((function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.ClientState||(t.ClientState={}))[n.Failed=0]="Failed",n[n.NoBrowserSupport=1]="NoBrowserSupport",n[n.NoAudioConsent=2]="NoAudioConsent",n[n.Disconnected=3]="Disconnected",n[n.Disconnecting=4]="Disconnecting",n[n.Connecting=5]="Connecting",n[n.Connected=6]="Connected",n[n.Starting=7]="Starting",n[n.Stopping=8]="Stopping",n[n.Recording=9]="Recording"}));var me=function(e){var t;return null!==(t=ge.get(e))&&void 0!==t?t:ve};const ve="Unknown",ge=new Map([[fe.ClientState.Failed,"Failed"],[fe.ClientState.NoBrowserSupport,"NoBrowserSupport"],[fe.ClientState.NoAudioConsent,"NoAudioConsent"],[fe.ClientState.Disconnecting,"Disconnecting"],[fe.ClientState.Disconnected,"Disconnected"],[fe.ClientState.Connecting,"Connecting"],[fe.ClientState.Connected,"Connected"],[fe.ClientState.Starting,"Starting"],[fe.ClientState.Stopping,"Stopping"],[fe.ClientState.Recording,"Recording"]]);var be=Object.defineProperty({stateToString:me},"__esModule",{value:!0});const Se={aa:{name:"Afar",nativeName:"Afaraf"},ab:{name:"Abkhaz",nativeName:"аҧсуа бызшәа"},ae:{name:"Avestan",nativeName:"avesta"},af:{name:"Afrikaans",nativeName:"Afrikaans"},ak:{name:"Akan",nativeName:"Akan"},am:{name:"Amharic",nativeName:"አማርኛ"},an:{name:"Aragonese",nativeName:"aragonés"},ar:{name:"Arabic",nativeName:"اللغة العربية"},as:{name:"Assamese",nativeName:"অসমীয়া"},av:{name:"Avaric",nativeName:"авар мацӀ"},ay:{name:"Aymara",nativeName:"aymar aru"},az:{name:"Azerbaijani",nativeName:"azərbaycan dili"},ba:{name:"Bashkir",nativeName:"башҡорт теле"},be:{name:"Belarusian",nativeName:"беларуская мова"},bg:{name:"Bulgarian",nativeName:"български език"},bh:{name:"Bihari",nativeName:"भोजपुरी"},bi:{name:"Bislama",nativeName:"Bislama"},bm:{name:"Bambara",nativeName:"bamanankan"},bn:{name:"Bengali",nativeName:"বাংলা"},bo:{name:"Tibetan",nativeName:"བོད་ཡིག"},br:{name:"Breton",nativeName:"brezhoneg"},bs:{name:"Bosnian",nativeName:"bosanski jezik"},ca:{name:"Catalan",nativeName:"Català"},ce:{name:"Chechen",nativeName:"нохчийн мотт"},ch:{name:"Chamorro",nativeName:"Chamoru"},co:{name:"Corsican",nativeName:"corsu"},cr:{name:"Cree",nativeName:"ᓀᐦᐃᔭᐍᐏᐣ"},cs:{name:"Czech",nativeName:"čeština"},cu:{name:"Old Church Slavonic",nativeName:"ѩзыкъ словѣньскъ"},cv:{name:"Chuvash",nativeName:"чӑваш чӗлхи"},cy:{name:"Welsh",nativeName:"Cymraeg"},da:{name:"Danish",nativeName:"dansk"},de:{name:"German",nativeName:"Deutsch"},dv:{name:"Divehi",nativeName:"Dhivehi"},dz:{name:"Dzongkha",nativeName:"རྫོང་ཁ"},ee:{name:"Ewe",nativeName:"Eʋegbe"},el:{name:"Greek",nativeName:"Ελληνικά"},en:{name:"English",nativeName:"English"},eo:{name:"Esperanto",nativeName:"Esperanto"},es:{name:"Spanish",nativeName:"Español"},et:{name:"Estonian",nativeName:"eesti"},eu:{name:"Basque",nativeName:"euskara"},fa:{name:"Persian",nativeName:"فارسی"},ff:{name:"Fula",nativeName:"Fulfulde"},fi:{name:"Finnish",nativeName:"suomi"},fj:{name:"Fijian",nativeName:"Vakaviti"},fo:{name:"Faroese",nativeName:"føroyskt"},fr:{name:"French",nativeName:"Français"},fy:{name:"Western Frisian",nativeName:"Frysk"},ga:{name:"Irish",nativeName:"Gaeilge"},gd:{name:"Scottish Gaelic",nativeName:"Gàidhlig"},gl:{name:"Galician",nativeName:"galego"},gn:{name:"Guaraní",nativeName:"Avañe'ẽ"},gu:{name:"Gujarati",nativeName:"ગુજરાતી"},gv:{name:"Manx",nativeName:"Gaelg"},ha:{name:"Hausa",nativeName:"هَوُسَ"},he:{name:"Hebrew",nativeName:"עברית"},hi:{name:"Hindi",nativeName:"हिन्दी"},ho:{name:"Hiri Motu",nativeName:"Hiri Motu"},hr:{name:"Croatian",nativeName:"Hrvatski"},ht:{name:"Haitian",nativeName:"Kreyòl ayisyen"},hu:{name:"Hungarian",nativeName:"magyar"},hy:{name:"Armenian",nativeName:"Հայերեն"},hz:{name:"Herero",nativeName:"Otjiherero"},ia:{name:"Interlingua",nativeName:"Interlingua"},id:{name:"Indonesian",nativeName:"Bahasa Indonesia"},ie:{name:"Interlingue",nativeName:"Interlingue"},ig:{name:"Igbo",nativeName:"Asụsụ Igbo"},ii:{name:"Nuosu",nativeName:"ꆈꌠ꒿ Nuosuhxop"},ik:{name:"Inupiaq",nativeName:"Iñupiaq"},io:{name:"Ido",nativeName:"Ido"},is:{name:"Icelandic",nativeName:"Íslenska"},it:{name:"Italian",nativeName:"Italiano"},iu:{name:"Inuktitut",nativeName:"ᐃᓄᒃᑎᑐᑦ"},ja:{name:"Japanese",nativeName:"日本語"},jv:{name:"Javanese",nativeName:"basa Jawa"},ka:{name:"Georgian",nativeName:"ქართული"},kg:{name:"Kongo",nativeName:"Kikongo"},ki:{name:"Kikuyu",nativeName:"Gĩkũyũ"},kj:{name:"Kwanyama",nativeName:"Kuanyama"},kk:{name:"Kazakh",nativeName:"қазақ тілі"},kl:{name:"Kalaallisut",nativeName:"kalaallisut"},km:{name:"Khmer",nativeName:"ខេមរភាសា"},kn:{name:"Kannada",nativeName:"ಕನ್ನಡ"},ko:{name:"Korean",nativeName:"한국어"},kr:{name:"Kanuri",nativeName:"Kanuri"},ks:{name:"Kashmiri",nativeName:"कश्मीरी"},ku:{name:"Kurdish",nativeName:"Kurdî"},kv:{name:"Komi",nativeName:"коми кыв"},kw:{name:"Cornish",nativeName:"Kernewek"},ky:{name:"Kyrgyz",nativeName:"Кыргызча"},la:{name:"Latin",nativeName:"latine"},lb:{name:"Luxembourgish",nativeName:"Lëtzebuergesch"},lg:{name:"Ganda",nativeName:"Luganda"},li:{name:"Limburgish",nativeName:"Limburgs"},ln:{name:"Lingala",nativeName:"Lingála"},lo:{name:"Lao",nativeName:"ພາສາ"},lt:{name:"Lithuanian",nativeName:"lietuvių kalba"},lu:{name:"Luba-Katanga",nativeName:"Tshiluba"},lv:{name:"Latvian",nativeName:"latviešu valoda"},mg:{name:"Malagasy",nativeName:"fiteny malagasy"},mh:{name:"Marshallese",nativeName:"Kajin M̧ajeļ"},mi:{name:"Māori",nativeName:"te reo Māori"},mk:{name:"Macedonian",nativeName:"македонски јазик"},ml:{name:"Malayalam",nativeName:"മലയാളം"},mn:{name:"Mongolian",nativeName:"Монгол хэл"},mr:{name:"Marathi",nativeName:"मराठी"},ms:{name:"Malay",nativeName:"Bahasa Malaysia"},mt:{name:"Maltese",nativeName:"Malti"},my:{name:"Burmese",nativeName:"ဗမာစာ"},na:{name:"Nauru",nativeName:"Ekakairũ Naoero"},nb:{name:"Norwegian Bokmål",nativeName:"Norsk bokmål"},nd:{name:"Northern Ndebele",nativeName:"isiNdebele"},ne:{name:"Nepali",nativeName:"नेपाली"},ng:{name:"Ndonga",nativeName:"Owambo"},nl:{name:"Dutch",nativeName:"Nederlands"},nn:{name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},no:{name:"Norwegian",nativeName:"Norsk"},nr:{name:"Southern Ndebele",nativeName:"isiNdebele"},nv:{name:"Navajo",nativeName:"Diné bizaad"},ny:{name:"Chichewa",nativeName:"chiCheŵa"},oc:{name:"Occitan",nativeName:"occitan"},oj:{name:"Ojibwe",nativeName:"ᐊᓂᔑᓈᐯᒧᐎᓐ"},om:{name:"Oromo",nativeName:"Afaan Oromoo"},or:{name:"Oriya",nativeName:"ଓଡ଼ିଆ"},os:{name:"Ossetian",nativeName:"ирон æвзаг"},pa:{name:"Panjabi",nativeName:"ਪੰਜਾਬੀ"},pi:{name:"Pāli",nativeName:"पाऴि"},pl:{name:"Polish",nativeName:"język polski"},ps:{name:"Pashto",nativeName:"پښتو"},pt:{name:"Portuguese",nativeName:"Português"},qu:{name:"Quechua",nativeName:"Runa Simi"},rm:{name:"Romansh",nativeName:"rumantsch grischun"},rn:{name:"Kirundi",nativeName:"Ikirundi"},ro:{name:"Romanian",nativeName:"Română"},ru:{name:"Russian",nativeName:"Русский"},rw:{name:"Kinyarwanda",nativeName:"Ikinyarwanda"},sa:{name:"Sanskrit",nativeName:"संस्कृतम्"},sc:{name:"Sardinian",nativeName:"sardu"},sd:{name:"Sindhi",nativeName:"सिन्धी"},se:{name:"Northern Sami",nativeName:"Davvisámegiella"},sg:{name:"Sango",nativeName:"yângâ tî sängö"},si:{name:"Sinhala",nativeName:"සිංහල"},sk:{name:"Slovak",nativeName:"slovenčina"},sl:{name:"Slovenian",nativeName:"slovenski jezik"},sm:{name:"Samoan",nativeName:"gagana fa'a Samoa"},sn:{name:"Shona",nativeName:"chiShona"},so:{name:"Somali",nativeName:"Soomaaliga"},sq:{name:"Albanian",nativeName:"Shqip"},sr:{name:"Serbian",nativeName:"српски језик"},ss:{name:"Swati",nativeName:"SiSwati"},st:{name:"Southern Sotho",nativeName:"Sesotho"},su:{name:"Sundanese",nativeName:"Basa Sunda"},sv:{name:"Swedish",nativeName:"Svenska"},sw:{name:"Swahili",nativeName:"Kiswahili"},ta:{name:"Tamil",nativeName:"தமிழ்"},te:{name:"Telugu",nativeName:"తెలుగు"},tg:{name:"Tajik",nativeName:"тоҷикӣ"},th:{name:"Thai",nativeName:"ไทย"},ti:{name:"Tigrinya",nativeName:"ትግርኛ"},tk:{name:"Turkmen",nativeName:"Türkmen"},tl:{name:"Tagalog",nativeName:"Wikang Tagalog"},tn:{name:"Tswana",nativeName:"Setswana"},to:{name:"Tonga",nativeName:"faka Tonga"},tr:{name:"Turkish",nativeName:"Türkçe"},ts:{name:"Tsonga",nativeName:"Xitsonga"},tt:{name:"Tatar",nativeName:"татар теле"},tw:{name:"Twi",nativeName:"Twi"},ty:{name:"Tahitian",nativeName:"Reo Tahiti"},ug:{name:"Uyghur",nativeName:"ئۇيغۇرچە‎"},uk:{name:"Ukrainian",nativeName:"Українська"},ur:{name:"Urdu",nativeName:"اردو"},uz:{name:"Uzbek",nativeName:"Ўзбек"},ve:{name:"Venda",nativeName:"Tshivenḓa"},vi:{name:"Vietnamese",nativeName:"Tiếng Việt"},vo:{name:"Volapük",nativeName:"Volapük"},wa:{name:"Walloon",nativeName:"walon"},wo:{name:"Wolof",nativeName:"Wollof"},xh:{name:"Xhosa",nativeName:"isiXhosa"},yi:{name:"Yiddish",nativeName:"ייִדיש"},yo:{name:"Yoruba",nativeName:"Yorùbá"},za:{name:"Zhuang",nativeName:"Saɯ cueŋƅ"},zh:{name:"Chinese",nativeName:"中文"},zu:{name:"Zulu",nativeName:"isiZulu"}};class ye{static getLanguages(e=[]){return e.map((e=>({code:e,name:ye.getName(e),nativeName:ye.getNativeName(e)})))}static getName(e){return ye.validate(e)?Se[e].name:""}static getAllNames(){return Object.values(Se).map((e=>e.name))}static getNativeName(e){return ye.validate(e)?Se[e].nativeName:""}static getAllNativeNames(){return Object.values(Se).map((e=>e.nativeName))}static getCode(e){return Object.keys(Se).find((t=>{const n=Se[t];return n.name.toLowerCase()===e.toLowerCase()||n.nativeName.toLowerCase()===e.toLowerCase()}))||""}static getAllCodes(){return Object.keys(Se)}static validate(e){return Se.hasOwnProperty(e)}}const we={aa:"阿法尔语",ab:"阿布哈兹语",ae:"阿维斯陀语",af:"南非荷兰语",ak:"阿坎语",am:"阿姆哈拉语",an:"阿拉贡语",ar:"阿拉伯语",as:"阿萨姆语",av:"阿瓦尔语",ay:"艾马拉语",az:"阿塞拜疆语",ba:"巴什基尔语",be:"白俄罗斯语",bg:"保加利亚语",bh:"比哈尔语",bi:"比斯拉马语",bm:"班巴拉语",bn:"孟加拉语",bo:"藏语",br:"布列塔尼语",bs:"波斯尼亚语",ca:"加泰罗尼亚语",ce:"车臣语",ch:"查莫洛语",co:"科西嘉语",cr:"克里语",cs:"捷克语",cu:"古教会斯拉夫语",cv:"楚瓦什语",cy:"威尔士语",da:"丹麦语",de:"德语",dv:"迪维希语",dz:"不丹语",ee:"埃维语",el:"希腊语",en:"英语",eo:"世界语",es:"西班牙语",et:"爱沙尼亚语",eu:"巴斯克语",fa:"波斯语",ff:"富拉语",fi:"芬兰语",fj:"斐济语",fo:"法罗语",fr:"法语",fy:"西弗里西亚语",ga:"爱尔兰语",gd:"苏格兰盖尔语",gl:"加利西亚语",gn:"瓜拉尼语",gu:"古吉拉特语",gv:"马恩岛语",ha:"豪萨语",he:"希伯来语",hi:"印地语",ho:"莫图语",hr:"克罗地亚语",ht:"海地文",hu:"匈牙利语",hy:"亚美尼亚语",hz:"赫勒娄语",ia:"国际语",id:"印尼语",ie:"国际语",ig:"伊博语",ii:"诺苏语",ik:"依奴皮维克文",io:"伊多文",is:"冰岛语",it:"意大利语",iu:"因纽特语",ja:"日语",jv:"爪哇语",ka:"格鲁吉亚语",kg:"刚果语",ki:"基库尤语",kj:"宽亚马语",kk:"哈萨克语",kl:"格陵兰语",km:"高棉语",kn:"卡纳达语",ko:"韩语",kr:"卡努里语",ks:"克什米尔语",ku:"库尔德语",kv:"科米语",kw:"科尼什语",ky:"吉尔吉斯语",la:"拉丁语",lb:"卢森堡语",lg:"甘达语",li:"林堡语",ln:"林加拉语",lo:"老挝语",lt:"立陶宛语",lu:"卢巴加丹加语",lv:"拉脱维亚语",mg:"马尔加什语",mh:"马绍尔语",mi:"毛利语",mk:"马其顿语",ml:"马拉雅拉姆语",mn:"蒙古文",mr:"马拉地语",ms:"马来语",mt:"马耳他语",my:"缅甸语",na:"瑙鲁语",nb:"挪威博克马尔语",nd:"北恩德贝勒语",ne:"尼泊尔语",ng:"尼日尔刚果语",nl:"荷兰语",nn:"挪威尼诺斯克语",no:"挪威语",nr:"南恩德贝勒语",nv:"纳瓦霍语",ny:"齐切瓦语",oc:"奥克西唐语",oj:"欧及布威语",om:"奥罗莫语",or:"奥里亚语",os:"奥塞梯语",pa:"旁遮普语",pi:"巴利语",pl:"波兰语",ps:"普什图语",pt:"葡萄牙语",qu:"克丘亚语",rm:"罗曼斯语",rn:"基隆迪语",ro:"罗马尼亚语",ru:"俄语",rw:"卢旺达语",sa:"梵文",sc:"撒丁岛语",sd:"信德语",se:"北萨米文",sg:"桑戈语",si:"僧伽罗语",sk:"斯洛伐克语",sl:"斯洛文尼亚语",sm:"萨摩亚语",sn:"绍纳语",so:"索马里语",sq:"阿尔巴尼亚语",sr:"塞尔维亚语",ss:"斯瓦蒂语",st:"南索托语",su:"巽他语",sv:"瑞典语",sw:"斯瓦希里语",ta:"泰米尔语",te:"泰卢固语",tg:"塔吉克语",th:"泰语",ti:"提格雷语",tk:"土库曼语",tl:"菲律宾语",tn:"茨瓦纳语",to:"汤加语",tr:"土耳其语",ts:"特松加语",tt:"塔塔尔语",tw:"契维语",ty:"塔希提语",ug:"维吾尔语",uk:"乌克兰语",ur:"乌尔都语",uz:"乌兹别克语",ve:"文达语",vi:"越南语",vo:"沃拉普克语",wa:"华隆语",wo:"沃洛夫语",xh:"科萨语",yi:"意第绪语",yo:"约鲁巴语",za:"壮语",zh:"中文",zu:"祖鲁语"};class Ce extends ye{static getLanguages(e){return super.getLanguages(e).map((e=>(Object.assign(e,{zhName:Ce.getZhName(e.code)}),e)))}static getZhName(e){return super.validate(e)?we[e]:""}static getAllZhNames(){return Object.values(we)}}var ke,Ne,xe=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function Te(e,t,n,i){return e.call(i,t[n],n,t)}var Ae=function(e,t,n){var i,a=0;for(i in null==ke&&function(){for(var e in Ne=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],ke=!0,{toString:null})ke=!1}(),e)if(!1===Te(t,e,i,n))break;if(ke)for(var o=e.constructor,r=!!o&&e===o.prototype;(i=Ne[a++])&&("constructor"===i&&(r||!xe(e,i))||e[i]===Object.prototype[i]||!1!==Te(t,e,i,n)););};var _e=function(e){var t=[];return Ae(e,(function(e,n){"function"==typeof e&&t.push(n)})),t.sort()};var Ee=function(e,t,n){var i=e.length;t=null==t?0:t<0?Math.max(i+t,0):Math.min(t,i),n=null==n?i:n<0?Math.max(i+n,0):Math.min(n,i);for(var a=[];t<n;)a.push(e[t++]);return a};var Re=function(e,t,n){var i=Ee(arguments,2);return function(){return e.apply(t,i.concat(Ee(arguments)))}};var Ie=function(e,t,n){if(null!=e)for(var i=-1,a=e.length;++i<a&&!1!==t.call(n,e[i],i,e););};var Me=function(e,t){var n=arguments.length>1?Ee(arguments,1):_e(e);Ie(n,(function(t){e[t]=Re(e[t],e)}))};var $e=function(e,t,n){Ae(e,(function(i,a){if(xe(e,a))return t.call(n,e[a],a,e)}))};var Oe=function(e){return e};var ze=function(e){return function(t){return t[e]}},Be=/^\[object (.*)\]$/,Pe=Object.prototype.toString;var Le=function(e){return null===e?"Null":undefined===e?"Undefined":Be.exec(Pe.call(e))[1]};var Fe=function(e,t){return Le(e)===t},De=Array.isArray||function(e){return Fe(e,"Array")};function We(e,t){for(var n=-1,i=e.length;++n<i;)if(je(e[n],t))return!0;return!1}function je(e,t){return e&&"object"==typeof e?De(e)&&De(t)?function(e,t){for(var n=-1,i=t.length;++n<i;)if(!We(e,t[n]))return!1;return!0}(e,t):function(e,t){var n=!0;return $e(t,(function(t,i){if(!je(e[i],t))return n=!1})),n}(e,t):e===t}var Ue=je;var Ge=function(e,t){if(null==e)return Oe;switch(typeof e){case"function":return void 0!==t?function(n,i,a){return e.call(t,n,i,a)}:e;case"object":return function(t){return Ue(t,e)};case"string":case"number":return ze(e)}};var Ke=function(e,t,n){t=Ge(t,n);var i=!1;return $e(e,(function(n,a){if(t(n,a,e))return i=!0,!1})),i};var He=function(e,t){return Ke(e,(function(e){return e===t}))};var Ve=function(e){return!!e&&"object"==typeof e&&e.constructor===Object};var Je=function e(t,n){for(var i,a=0,o=arguments.length;++a<o;)(i=arguments[a])&&$e(i,(function(n,i){var a=t[i];null==a?t[i]=n:Ve(a)&&Ve(n)&&e(a,n)}));return t};function Ze(e,t){for(var n,i=0,a=arguments.length;++i<a;)(n=arguments[i])&&$e(n,qe,e);return e}function qe(e,t){var n=this[t];Ve(e)&&Ve(n)?Ze(n,e):this[t]=e}var Xe=Ze;var Ye=function(e,t,n){t=Ge(t,n);var i=!0;return $e(e,(function(n,a){if(!t(n,a,e))return i=!1,!1})),i};var Qe=function(e){return Fe(e,"Object")};var et=function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};function tt(e,t){return xe(this,t)}var nt=function(e,t,n){return n=n||et,Qe(e)&&Qe(t)?Ye(e,function(e){return function(t,n){return xe(this,n)&&e(t,this[n])}}(n),t)&&Ye(t,tt,e):n(e,t)};var it=function(e,t){return Ie(Ee(arguments,1),(function(t){$e(t,(function(t,n){null==e[n]&&(e[n]=t)}))})),e};var at=function(e,t,n){t=Ge(t,n);var i={};return $e(e,(function(e,n,a){t(e,n,a)&&(i[n]=e)})),i};var ot=function(e,t,n){var i;return t=Ge(t,n),Ke(e,(function(e,n,a){if(t(e,n,a))return i=e,!0})),i};function rt(e,t,n,i){return $e(e,(function(e,a){var o=n?n+"."+a:a;0!==i&&Ve(e)?rt(e,t,o,i-1):t[o]=e})),t}var st=function(e,t){return null==e?{}:rt(e,{},"",t=null==t?-1:t)};var ct=function(e,t){for(var n=t.split("."),i=n.pop();t=n.shift();)if(null==(e=e[t]))return;return e[i]};var ut=function(e,t){return undefined!==ct(e,t)},lt=Object.keys||function(e){var t=[];return $e(e,(function(e,n){t.push(n)})),t};var ht=function(e,t,n){t=Ge(t,n);var i={};return $e(e,(function(e,n,a){i[n]=t(e,n,a)})),i};var dt=function(e,t){var n=!0;return $e(t,(function(t,i){if(e[i]!==t)return n=!1})),n};var pt=function(e,t,n){if(null!=e&&e.length){if(e.length&&!t)return Math.max.apply(Math,e);t=Ge(t,n);for(var i,a,o,r=-1/0,s=-1,c=e.length;++s<c;)(o=t(a=e[s],s,e))>r&&(r=o,i=a);return i}return 1/0};var ft=function(e){var t=[];return $e(e,(function(e,n){t.push(e)})),t};function mt(e,t){this[t]=e}var vt=function(e,t){for(var n,i=0,a=arguments.length;++i<a;)null!=(n=arguments[i])&&$e(n,mt,e);return e};var gt=function(e){switch(Le(e)){case"Object":return Ve(i=e)?vt({},i):i;case"Array":return e.slice();case"RegExp":return n="",n+=(t=e).multiline?"m":"",n+=t.global?"g":"",n+=t.ignoreCase?"i":"",new RegExp(t.source,n);case"Date":return new Date(+e);default:return e}var t,n,i};function bt(e,t){switch(Le(e)){case"Object":return function(e,t){if(Ve(e)){var n={};return $e(e,(function(e,n){this[n]=bt(e,t)}),n),n}return t?t(e):e}(e,t);case"Array":return function(e,t){var n=[],i=-1,a=e.length;for(;++i<a;)n[i]=bt(e[i],t);return n}(e,t);default:return gt(e)}}var St=bt;var yt=function e(){var t,n,i,a,o=1;for(a=St(arguments[0]);i=arguments[o++];)for(t in i)xe(i,t)&&(n=i[t],Qe(n)&&Qe(a[t])?a[t]=e(a[t],n):a[t]=St(n));return a};var wt=function(e,t,n){if(null!=e&&e.length){if(e.length&&!t)return Math.min.apply(Math,e);t=Ge(t,n);for(var i,a,o,r=1/0,s=-1,c=e.length;++s<c;)(o=t(a=e[s],s,e))<r&&(r=o,i=a);return i}return-1/0};var Ct=function(e,t){return t?(Ie(t.split("."),(function(t){e[t]||(e[t]={}),e=e[t]})),e):e};var kt=function(e,t,n){if(n=n||0,null==e)return-1;for(var i=e.length,a=n<0?i+n:n;a<i;){if(e[a]===t)return a;a++}return-1};var Nt=function(e,t){return-1!==kt(e,t)};var xt=function(e,t){return ht(e,ze(t))};var Tt=function(e){var t=0;return $e(e,(function(){t++})),t};var At=function(e,t,n,i){var a=arguments.length>2;if(!Tt(e)&&!a)throw new Error("reduce of empty object with no initial value");return $e(e,(function(e,o,r){a?n=t.call(i,n,e,o,r):(n=e,a=!0)})),n};var _t=function(e,t,n){return t=Ge(t,n),at(e,(function(e,n,i){return!t(e,n,i)}),n)};var Et=function(e){return Fe(e,"Function")};var Rt=function(e,t,n){var i=/^(.+)\.(.+)$/.exec(t);i?Ct(e,i[1])[i[2]]=n:e[t]=n};var It=function(e,t){if(ut(e,t)){for(var n=t.split("."),i=n.pop();t=n.shift();)e=e[t];return delete e[i]}return!0},Mt={bindAll:Me,contains:He,deepFillIn:Je,deepMatches:Ue,deepMixIn:Xe,equals:nt,every:Ye,fillIn:it,filter:at,find:ot,flatten:st,forIn:Ae,forOwn:$e,functions:_e,get:ct,has:ut,hasOwn:xe,keys:lt,map:ht,matches:dt,max:function(e,t){return pt(ft(e),t)},merge:yt,min:function(e,t){return wt(ft(e),t)},mixIn:vt,namespace:Ct,omit:function(e,t){var n="string"!=typeof arguments[1]?arguments[1]:Ee(arguments,1),i={};for(var a in e)e.hasOwnProperty(a)&&!Nt(n,a)&&(i[a]=e[a]);return i},pick:function(e,t){for(var n,i="string"!=typeof arguments[1]?arguments[1]:Ee(arguments,1),a={},o=0;n=i[o++];)a[n]=e[n];return a},pluck:xt,reduce:At,reject:_t,result:function(e,t){var n=e[t];if(void 0!==n)return Et(n)?n.call(e):n},set:Rt,size:Tt,some:Ke,unset:It,values:ft},$t=pe((function(e){(function(){var t,n,i;n=Mt,t=function(){function e(){}return e.prototype.getCountry=function(t){return e.prototype.countries[t]},e.prototype.getCode=function(t){var i,a;return a=null,null!=t&&-1!==(i=n.values(e.prototype.countries).indexOf(t))&&(a=Object.keys(e.prototype.countries)[i]),a},e.prototype.getCountries=function(){return n.values(e.prototype.countries)},e.prototype.getCodes=function(){return Object.keys(e.prototype.countries)},e.prototype.getData=function(){return e.prototype.countries},e.prototype.countries={AF:"Afghanistan",AX:"Åland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, the Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",CI:"Côte d'Ivoire",HR:"Croatia",CU:"Cuba",CW:"Curaçao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, the Former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Réunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthélemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province of China",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela, Bolivarian Republic of",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},e}(),i=null,e.exports=null!=i?i:i=new t}).call(he)}));const Ot=/^([a-z]{2})-([A-Z]{2})$/;class zt{static getLanguageCode(e){var t=e.match(Ot);return!t||t.length<1?"":t[1]}static getLanguageName(e){var t=zt.getLanguageCode(e);return Ce.getName(t)}static getLanguageNativeName(e){var t=zt.getLanguageCode(e);return Ce.getNativeName(t)}static getLanguageZhName(e){var t=zt.getLanguageCode(e);return Ce.getZhName(t)}static validateLanguageCode(e){var t=zt.getLanguageCode(e);return Ce.validate(t)}static getLanguages(e){for(var t=[],n=0;n<e.length;n++)t.push({code:e[n],name:zt.getLanguageName(e[n]),nativeName:zt.getLanguageNativeName(e[n]),zhName:zt.getLanguageZhName(e[n])});return t}static getCountryCode(e){var t=e.match(Ot);return!t||t.length<2?"":t[2]}static getCountryName(e){var t=zt.getCountryCode(e);return $t.getCountry(t)}static validateCountryCode(e){return e=zt.getCountryCode(e),-1!==$t.getCodes().indexOf(e)}static validate(e){var t=e.match(Ot);return!!(t&&3===t.length&&zt.validateLanguageCode(e)&&zt.validateCountryCode(e))}}var Bt,Pt=Object.freeze({__proto__:null,default:zt}),Lt=new Uint8Array(16);function Ft(){if(!Bt&&!(Bt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Bt(Lt)}var Dt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Wt(e){return"string"==typeof e&&Dt.test(e)}for(var jt,Ut,Gt=[],Kt=0;Kt<256;++Kt)Gt.push((Kt+256).toString(16).substr(1));function Ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Gt[e[t+0]]+Gt[e[t+1]]+Gt[e[t+2]]+Gt[e[t+3]]+"-"+Gt[e[t+4]]+Gt[e[t+5]]+"-"+Gt[e[t+6]]+Gt[e[t+7]]+"-"+Gt[e[t+8]]+Gt[e[t+9]]+"-"+Gt[e[t+10]]+Gt[e[t+11]]+Gt[e[t+12]]+Gt[e[t+13]]+Gt[e[t+14]]+Gt[e[t+15]]).toLowerCase();if(!Wt(n))throw TypeError("Stringified UUID is invalid");return n}var Vt=0,Jt=0;function Zt(e){if(!Wt(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}function qt(e,t,n){function i(e,i,a,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof i&&(i=Zt(i)),16!==i.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var r=new Uint8Array(16+e.length);if(r.set(i),r.set(e,i.length),(r=n(r))[6]=15&r[6]|t,r[8]=63&r[8]|128,a){o=o||0;for(var s=0;s<16;++s)a[o+s]=r[s];return a}return Ht(r)}try{i.name=e}catch(e){}return i.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",i.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",i}function Xt(e){return 14+(e+64>>>9<<4)+1}function Yt(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function Qt(e,t,n,i,a,o){return Yt((r=Yt(Yt(t,e),Yt(i,o)))<<(s=a)|r>>>32-s,n);var r,s}function en(e,t,n,i,a,o,r){return Qt(t&n|~t&i,e,t,a,o,r)}function tn(e,t,n,i,a,o,r){return Qt(t&i|n&~i,e,t,a,o,r)}function nn(e,t,n,i,a,o,r){return Qt(t^n^i,e,t,a,o,r)}function an(e,t,n,i,a,o,r){return Qt(n^(t|~i),e,t,a,o,r)}var on=qt("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,i="0123456789abcdef",a=0;a<n;a+=8){var o=e[a>>5]>>>a%32&255,r=parseInt(i.charAt(o>>>4&15)+i.charAt(15&o),16);t.push(r)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[Xt(t)-1]=t;for(var n=1732584193,i=-271733879,a=-1732584194,o=271733878,r=0;r<e.length;r+=16){var s=n,c=i,u=a,l=o;n=en(n,i,a,o,e[r],7,-680876936),o=en(o,n,i,a,e[r+1],12,-389564586),a=en(a,o,n,i,e[r+2],17,606105819),i=en(i,a,o,n,e[r+3],22,-1044525330),n=en(n,i,a,o,e[r+4],7,-176418897),o=en(o,n,i,a,e[r+5],12,1200080426),a=en(a,o,n,i,e[r+6],17,-1473231341),i=en(i,a,o,n,e[r+7],22,-45705983),n=en(n,i,a,o,e[r+8],7,1770035416),o=en(o,n,i,a,e[r+9],12,-1958414417),a=en(a,o,n,i,e[r+10],17,-42063),i=en(i,a,o,n,e[r+11],22,-1990404162),n=en(n,i,a,o,e[r+12],7,1804603682),o=en(o,n,i,a,e[r+13],12,-40341101),a=en(a,o,n,i,e[r+14],17,-1502002290),n=tn(n,i=en(i,a,o,n,e[r+15],22,1236535329),a,o,e[r+1],5,-165796510),o=tn(o,n,i,a,e[r+6],9,-1069501632),a=tn(a,o,n,i,e[r+11],14,643717713),i=tn(i,a,o,n,e[r],20,-373897302),n=tn(n,i,a,o,e[r+5],5,-701558691),o=tn(o,n,i,a,e[r+10],9,38016083),a=tn(a,o,n,i,e[r+15],14,-660478335),i=tn(i,a,o,n,e[r+4],20,-405537848),n=tn(n,i,a,o,e[r+9],5,568446438),o=tn(o,n,i,a,e[r+14],9,-1019803690),a=tn(a,o,n,i,e[r+3],14,-187363961),i=tn(i,a,o,n,e[r+8],20,1163531501),n=tn(n,i,a,o,e[r+13],5,-1444681467),o=tn(o,n,i,a,e[r+2],9,-51403784),a=tn(a,o,n,i,e[r+7],14,1735328473),n=nn(n,i=tn(i,a,o,n,e[r+12],20,-1926607734),a,o,e[r+5],4,-378558),o=nn(o,n,i,a,e[r+8],11,-2022574463),a=nn(a,o,n,i,e[r+11],16,1839030562),i=nn(i,a,o,n,e[r+14],23,-35309556),n=nn(n,i,a,o,e[r+1],4,-1530992060),o=nn(o,n,i,a,e[r+4],11,1272893353),a=nn(a,o,n,i,e[r+7],16,-155497632),i=nn(i,a,o,n,e[r+10],23,-1094730640),n=nn(n,i,a,o,e[r+13],4,681279174),o=nn(o,n,i,a,e[r],11,-358537222),a=nn(a,o,n,i,e[r+3],16,-722521979),i=nn(i,a,o,n,e[r+6],23,76029189),n=nn(n,i,a,o,e[r+9],4,-640364487),o=nn(o,n,i,a,e[r+12],11,-421815835),a=nn(a,o,n,i,e[r+15],16,530742520),n=an(n,i=nn(i,a,o,n,e[r+2],23,-995338651),a,o,e[r],6,-198630844),o=an(o,n,i,a,e[r+7],10,1126891415),a=an(a,o,n,i,e[r+14],15,-1416354905),i=an(i,a,o,n,e[r+5],21,-57434055),n=an(n,i,a,o,e[r+12],6,1700485571),o=an(o,n,i,a,e[r+3],10,-1894986606),a=an(a,o,n,i,e[r+10],15,-1051523),i=an(i,a,o,n,e[r+1],21,-2054922799),n=an(n,i,a,o,e[r+8],6,1873313359),o=an(o,n,i,a,e[r+15],10,-30611744),a=an(a,o,n,i,e[r+6],15,-1560198380),i=an(i,a,o,n,e[r+13],21,1309151649),n=an(n,i,a,o,e[r+4],6,-145523070),o=an(o,n,i,a,e[r+11],10,-1120210379),a=an(a,o,n,i,e[r+2],15,718787259),i=an(i,a,o,n,e[r+9],21,-343485551),n=Yt(n,s),i=Yt(i,c),a=Yt(a,u),o=Yt(o,l)}return[n,i,a,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(Xt(t)),i=0;i<t;i+=8)n[i>>5]|=(255&e[i/8])<<i%32;return n}(e),8*e.length))}));function rn(e,t,n,i){switch(e){case 0:return t&n^~t&i;case 1:return t^n^i;case 2:return t&n^t&i^n&i;case 3:return t^n^i}}function sn(e,t){return e<<t|e>>>32-t}var cn=qt("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var i=unescape(encodeURIComponent(e));e=[];for(var a=0;a<i.length;++a)e.push(i.charCodeAt(a))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,r=Math.ceil(o/16),s=new Array(r),c=0;c<r;++c){for(var u=new Uint32Array(16),l=0;l<16;++l)u[l]=e[64*c+4*l]<<24|e[64*c+4*l+1]<<16|e[64*c+4*l+2]<<8|e[64*c+4*l+3];s[c]=u}s[r-1][14]=8*(e.length-1)/Math.pow(2,32),s[r-1][14]=Math.floor(s[r-1][14]),s[r-1][15]=8*(e.length-1)&4294967295;for(var h=0;h<r;++h){for(var d=new Uint32Array(80),p=0;p<16;++p)d[p]=s[h][p];for(var f=16;f<80;++f)d[f]=sn(d[f-3]^d[f-8]^d[f-14]^d[f-16],1);for(var m=n[0],v=n[1],g=n[2],b=n[3],S=n[4],y=0;y<80;++y){var w=Math.floor(y/20),C=sn(m,5)+rn(w,v,g,b)+S+t[w]+d[y]>>>0;S=b,b=g,g=sn(v,30)>>>0,v=m,m=C}n[0]=n[0]+m>>>0,n[1]=n[1]+v>>>0,n[2]=n[2]+g>>>0,n[3]=n[3]+b>>>0,n[4]=n[4]+S>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}));var un=Object.freeze({__proto__:null,v1:function(e,t,n){var i=t&&n||0,a=t||new Array(16),o=(e=e||{}).node||jt,r=void 0!==e.clockseq?e.clockseq:Ut;if(null==o||null==r){var s=e.random||(e.rng||Ft)();null==o&&(o=jt=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==r&&(r=Ut=16383&(s[6]<<8|s[7]))}var c=void 0!==e.msecs?e.msecs:Date.now(),u=void 0!==e.nsecs?e.nsecs:Jt+1,l=c-Vt+(u-Jt)/1e4;if(l<0&&void 0===e.clockseq&&(r=r+1&16383),(l<0||c>Vt)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Vt=c,Jt=u,Ut=r;var h=(1e4*(268435455&(c+=122192928e5))+u)%4294967296;a[i++]=h>>>24&255,a[i++]=h>>>16&255,a[i++]=h>>>8&255,a[i++]=255&h;var d=c/4294967296*1e4&268435455;a[i++]=d>>>8&255,a[i++]=255&d,a[i++]=d>>>24&15|16,a[i++]=d>>>16&255,a[i++]=r>>>8|128,a[i++]=255&r;for(var p=0;p<6;++p)a[i+p]=o[p];return t||Ht(a)},v3:on,v4:function(e,t,n){var i=(e=e||{}).random||(e.rng||Ft)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=i[a];return t}return Ht(i)},v5:cn,NIL:"00000000-0000-0000-0000-000000000000",version:function(e){if(!Wt(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)},validate:Wt,stringify:Ht,parse:Zt}),ln=pe((function(e,t){!function(n){var i=t,a=e&&e.exports==i&&e,o="object"==typeof he&&he;o.global!==o&&o.window!==o||(n=o);var r=function(e){this.message=e};(r.prototype=new Error).name="InvalidCharacterError";var s=function(e){throw new r(e)},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=/[\t\n\f\r ]/g,l={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var t,n,i,a,o=e.length%3,r="",u=-1,l=e.length-o;++u<l;)t=e.charCodeAt(u)<<16,n=e.charCodeAt(++u)<<8,i=e.charCodeAt(++u),r+=c.charAt((a=t+n+i)>>18&63)+c.charAt(a>>12&63)+c.charAt(a>>6&63)+c.charAt(63&a);return 2==o?(t=e.charCodeAt(u)<<8,n=e.charCodeAt(++u),r+=c.charAt((a=t+n)>>10)+c.charAt(a>>4&63)+c.charAt(a<<2&63)+"="):1==o&&(a=e.charCodeAt(u),r+=c.charAt(a>>2)+c.charAt(a<<4&63)+"=="),r},decode:function(e){var t=(e=String(e).replace(u,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var n,i,a=0,o="",r=-1;++r<t;)i=c.indexOf(e.charAt(r)),n=a%4?64*n+i:i,a++%4&&(o+=String.fromCharCode(255&n>>(-2*a&6)));return o},version:"0.1.0"};if(i&&!i.nodeType)if(a)a.exports=l;else for(var h in l)l.hasOwnProperty(h)&&(i[h]=l[h]);else n.base64=l}(he)})),hn=pe((function(e,t){var n=he&&he.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};function i(e,n,i,o,r=Date.now){const s=a(e);return!(s.expiresAtMs-r()<t.minTokenValidTime)&&(s.appId===i&&s.projectId===n&&s.deviceId===o)}function a(e){const t=e.split(".")[1];let n;try{n=JSON.parse(ln.decode(t))}catch(e){throw new Error("Error decoding Speechly token!")}return{appId:n.appId,projectId:n.projectId,deviceId:n.deviceId,configId:n.configId,scopes:n.scope.split(" "),issuer:n.iss,audience:n.aud,expiresAtMs:1e3*n.exp}}Object.defineProperty(t,"__esModule",{value:!0}),t.minTokenValidTime=36e5,t.fetchToken=function(e,t,a,o,r=fetch,s=Date.now){var c;return n(this,void 0,void 0,(function*(){let n;n=void 0!==t?{projectId:t,deviceId:o}:{appId:a,deviceId:o};const u=yield r(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),l=yield u.json();if(200!==u.status)throw Error(null!==(c=l.error)&&void 0!==c?c:`Speechly API login request failed with ${u.status}`);if(void 0===l.access_token)throw Error("Invalid login response from Speechly API");if(!i(l.access_token,t,a,o,s))throw Error("Invalid token received from Speechly API");return l.access_token}))},t.validateToken=i,t.decodeToken=a})),dn=new Error("Microphone is not initialized"),pn=new Error("Microphone is already initialized"),fn=new Error("Current device does not support microphone API"),mn=new Error("Microphone consent is no given"),vn=Object.defineProperty({DefaultSampleRate:16e3,ErrNotInitialized:dn,ErrAlreadyInitialized:pn,ErrDeviceNotSupported:fn,ErrNoAudioConsent:mn},"__esModule",{value:!0}),gn=Object.defineProperty({default:"\n// Indices for the Control SAB.\nconst CONTROL = {\n  'WRITE_INDEX': 0,\n  'FRAMES_AVAILABLE': 1,\n  'LOCK': 2,\n};\n\nclass SpeechlyProcessor extends AudioWorkletProcessor {\n  constructor() {\n    super();\n\n    this._initialized = false;\n    this.port.onmessage = this._initialize.bind(this);\n  }\n\n  _initialize(event) {\n    this.controlSAB = new Int32Array(event.data.controlSAB);\n    this.dataSAB = new Float32Array(event.data.dataSAB);\n    this.sharedBufferSize = this.dataSAB.length;\n    this.buffer = new Float32Array(0);\n    this._initialized = true;\n  }\n\n  _transferDataToSharedBuffer(data) {\n    this.controlSAB[CONTROL.LOCK] = 1\n    let inputWriteIndex = this.controlSAB[CONTROL.WRITE_INDEX]\n    if (this.controlSAB[CONTROL.FRAMES_AVAILABLE] > 0) {\n      if (inputWriteIndex + data.length > this.sharedBufferSize) {\n        // console.log('buffer overflow')\n        inputWriteIndex = 0\n      }\n    }\n    this.dataSAB.set(data, inputWriteIndex)\n    this.controlSAB[CONTROL.WRITE_INDEX] = inputWriteIndex + data.length\n    this.controlSAB[CONTROL.FRAMES_AVAILABLE] = inputWriteIndex + data.length\n    this.controlSAB[CONTROL.LOCK] = 0\n  }\n\n  _pushData(data) {\n    if (this.buffer.length > this.sharedBufferSize) {\n      const dataToTransfer = this.buffer.subarray(0, this.sharedBufferSize)\n      this._transferDataToSharedBuffer(dataToTransfer)\n      this.buffer = this.buffer.subarray(this.sharedBufferSize)\n    }\n    let concat = new Float32Array(this.buffer.length + data.length)\n    concat.set(this.buffer)\n    concat.set(data, this.buffer.length)\n    this.buffer = concat\n  }\n\n  process(inputs, outputs, parameters) {\n    const inputChannelData = inputs[0][0];\n      if (inputChannelData !== undefined) {\n        if (this.controlSAB && this.dataSAB) {\n          this._pushData(inputChannelData);\n        } else {\n          this.port.postMessage(inputChannelData);\n        }\n      }\n      \n      return true;\n  }\n}\n\nregisterProcessor('speechly-worklet', SpeechlyProcessor);\n"},"__esModule",{value:!0}),bn=he&&he.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};
/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */const Sn=(he&&he.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(gn);var yn=class{constructor(e,t,n,i=!1){this.initialized=!1,this.muted=!1,this.handleAudio=e=>{this.muted||e.length>0&&this.apiClient.sendAudio(e)},this.isWebkit=e,this.apiClient=n,this.sampleRate=t,this.debug=i}initialize(e,t){var n;return bn(this,void 0,void 0,(function*(){if(void 0===(null===(n=window.navigator)||void 0===n?void 0:n.mediaDevices))throw vn.ErrDeviceNotSupported;this.audioContext=e,this.resampleRatio=this.audioContext.sampleRate/this.sampleRate;try{this.mediaStream=yield window.navigator.mediaDevices.getUserMedia(t)}catch(e){throw vn.ErrNoAudioConsent}if(this.audioTrack=this.mediaStream.getAudioTracks()[0],this.isWebkit||(yield this.audioContext.resume()),void 0!==window.AudioWorkletNode){const e=new Blob([Sn.default],{type:"text/javascript"}),t=window.URL.createObjectURL(e);yield this.audioContext.audioWorklet.addModule(t);const n=new AudioWorkletNode(this.audioContext,"speechly-worklet");if(this.audioContext.createMediaStreamSource(this.mediaStream).connect(n),n.connect(this.audioContext.destination),void 0!==window.SharedArrayBuffer){const e=new window.SharedArrayBuffer(4*Int32Array.BYTES_PER_ELEMENT),t=new window.SharedArrayBuffer(1024*Float32Array.BYTES_PER_ELEMENT);this.apiClient.postMessage({type:"SET_SHARED_ARRAY_BUFFERS",controlSAB:e,dataSAB:t}),n.port.postMessage({type:"SET_SHARED_ARRAY_BUFFERS",controlSAB:e,dataSAB:t})}else this.debug&&console.log("[SpeechlyClient]","can not use SharedArrayBuffer"),n.port.onmessage=e=>{this.handleAudio(e.data)}}else{if(this.debug&&console.log("[SpeechlyClient]","can not use AudioWorkletNode"),this.isWebkit){const e=4096*Math.pow(2,Math.ceil(Math.log(this.resampleRatio)/Math.log(2)));this.audioProcessor=this.audioContext.createScriptProcessor(e,1,1)}else this.audioProcessor=this.audioContext.createScriptProcessor(void 0,1,1);this.audioContext.createMediaStreamSource(this.mediaStream).connect(this.audioProcessor),this.audioProcessor.connect(this.audioContext.destination),this.audioProcessor.addEventListener("audioprocess",(e=>{this.handleAudio(e.inputBuffer.getChannelData(0))}))}this.initialized=!0,this.mute()}))}close(){return bn(this,void 0,void 0,(function*(){if(this.mute(),!this.initialized)throw vn.ErrNotInitialized;this.audioTrack.enabled=!1;if(this.mediaStream.getTracks().forEach((e=>e.stop())),null!=this.audioProcessor){this.audioProcessor.disconnect()}this.mediaStream=void 0,this.audioTrack=void 0,this.audioProcessor=void 0,this.initialized=!1}))}mute(){this.muted=!0}unmute(){this.muted=!1}},wn=Object.defineProperty({BrowserMicrophone:yn},"__esModule",{value:!0}),Cn=pe((function(e,t){function n(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(wn),n(vn)})),kn=pe((function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.WebsocketResponseType||(t.WebsocketResponseType={})).Opened="WEBSOCKET_OPEN",n.SourceSampleRateSetSuccess="SOURSE_SAMPLE_RATE_SET_SUCCESS",n.Started="started",n.Stopped="stopped",n.SegmentEnd="segment_end",n.Transcript="transcript",n.Entity="entity",n.Intent="intent",n.TentativeTranscript="tentative_transcript",n.TentativeEntities="tentative_entities",n.TentativeIntent="tentative_intent"})),Nn=Object.defineProperty({default:"/**\n * Known WebSocket response types.\n * @public\n */\nvar WebsocketResponseType;\n(function (WebsocketResponseType) {\n    WebsocketResponseType[\"Opened\"] = \"WEBSOCKET_OPEN\";\n    WebsocketResponseType[\"SourceSampleRateSetSuccess\"] = \"SOURSE_SAMPLE_RATE_SET_SUCCESS\";\n    WebsocketResponseType[\"Started\"] = \"started\";\n    WebsocketResponseType[\"Stopped\"] = \"stopped\";\n})(WebsocketResponseType || (WebsocketResponseType = {}));\nvar CONTROL = {\n    WRITE_INDEX: 0,\n    FRAMES_AVAILABLE: 1,\n    LOCK: 2\n};\nvar WebsocketClient = /** @class */ (function () {\n    function WebsocketClient(ctx) {\n        var _this = this;\n        this.isContextStarted = false;\n        this.isStartContextConfirmed = false;\n        this.shouldResendLastFramesSent = false;\n        this.buffer = new Float32Array(0);\n        this.lastFramesSent = new Int16Array(0); // to re-send after switch context\n        this.debug = false;\n        this.initialized = false;\n        this.onWebsocketClose = function (event) {\n            _this.websocket = undefined;\n            _this.connect(0);\n        };\n        this.onWebsocketOpen = function (_event) {\n            if (_this.debug) {\n                console.log('[SpeechlyClient]', 'websocket opened');\n            }\n            _this.workerCtx.postMessage({ type: 'WEBSOCKET_OPEN' });\n        };\n        this.onWebsocketError = function (_event) {\n            if (_this.debug) {\n                console.log('[SpeechlyClient]', 'websocket error');\n            }\n            _this.closeWebsocket();\n        };\n        this.onWebsocketMessage = function (event) {\n            var response;\n            try {\n                response = JSON.parse(event.data);\n            }\n            catch (e) {\n                console.error('[SpeechlyClient] Error parsing response from the server:', e);\n                return;\n            }\n            if (response.type === WebsocketResponseType.Started) {\n                _this.isStartContextConfirmed = true;\n                if (_this.shouldResendLastFramesSent) {\n                    _this.resendLastFrames();\n                    _this.shouldResendLastFramesSent = false;\n                }\n            }\n            _this.workerCtx.postMessage(response);\n        };\n        this.workerCtx = ctx;\n    }\n    WebsocketClient.prototype.init = function (apiUrl, authToken, targetSampleRate, debug) {\n        if (this.initialized) {\n            console.log('[SpeechlyClient]', 'already initialized');\n            return;\n        }\n        this.debug = debug;\n        if (this.debug) {\n            console.log('[SpeechlyClient]', 'initialize worker');\n        }\n        this.apiUrl = apiUrl;\n        this.authToken = authToken;\n        this.targetSampleRate = targetSampleRate;\n        this.initialized = true;\n        this.connect(0);\n    };\n    WebsocketClient.prototype.setSourceSampleRate = function (sourceSampleRate) {\n        this.sourceSampleRate = sourceSampleRate;\n        this.resampleRatio = this.sourceSampleRate / this.targetSampleRate;\n        if (this.debug) {\n            console.log('[SpeechlyClient]', 'resampleRatio', this.resampleRatio);\n        }\n        if (this.resampleRatio > 1) {\n            this.filter = generateFilter(this.sourceSampleRate, this.targetSampleRate, 127);\n        }\n        this.workerCtx.postMessage({ type: 'SOURSE_SAMPLE_RATE_SET_SUCCESS' });\n        if (isNaN(this.resampleRatio)) {\n            throw Error(\"resampleRatio is NaN source rate is \" + this.sourceSampleRate + \" and target rate is \" + this.targetSampleRate);\n        }\n    };\n    WebsocketClient.prototype.setSharedArrayBuffers = function (controlSAB, dataSAB) {\n        this.controlSAB = new Int32Array(controlSAB);\n        this.dataSAB = new Float32Array(dataSAB);\n        var audioHandleInterval = this.dataSAB.length / 32; // ms\n        if (this.debug) {\n            console.log('[SpeechlyClient]', 'Audio handle interval', audioHandleInterval, 'ms');\n        }\n        setInterval(this.sendAudioFromSAB.bind(this), audioHandleInterval);\n    };\n    WebsocketClient.prototype.connect = function (timeout) {\n        if (timeout === void 0) { timeout = 1000; }\n        if (this.debug) {\n            console.log('[SpeechlyClient]', 'connect in ', timeout / 1000, 'sec');\n        }\n        setTimeout(this.initializeWebsocket.bind(this), timeout);\n    };\n    WebsocketClient.prototype.initializeWebsocket = function () {\n        if (this.debug) {\n            console.log('[SpeechlyClient]', 'connecting to ', this.apiUrl);\n        }\n        this.websocket = new WebSocket(this.apiUrl, this.authToken);\n        this.websocket.addEventListener('open', this.onWebsocketOpen);\n        this.websocket.addEventListener('message', this.onWebsocketMessage);\n        this.websocket.addEventListener('error', this.onWebsocketError);\n        this.websocket.addEventListener('close', this.onWebsocketClose);\n    };\n    WebsocketClient.prototype.isOpen = function () {\n        return this.websocket !== undefined && this.websocket.readyState === this.websocket.OPEN;\n    };\n    WebsocketClient.prototype.resendLastFrames = function () {\n        if (!this.isOpen()) {\n            return Error('Cannot resend data through inactive websocket');\n        }\n        if (this.lastFramesSent.length > 0) {\n            this.websocket.send(this.lastFramesSent);\n            this.lastFramesSent = new Int16Array(0);\n        }\n    };\n    WebsocketClient.prototype.sendAudio = function (audioChunk) {\n        if (!this.isContextStarted) {\n            return;\n        }\n        if (!this.isOpen()) {\n            return Error('Cannot send data through inactive websocket');\n        }\n        if (audioChunk.length > 0) {\n            if (this.resampleRatio > 1) {\n                // Downsampling\n                this.websocket.send(this.downsample(audioChunk));\n            }\n            else {\n                this.websocket.send(float32ToInt16(audioChunk));\n            }\n        }\n    };\n    WebsocketClient.prototype.sendAudioFromSAB = function () {\n        if (!this.isContextStarted) {\n            this.controlSAB[CONTROL.FRAMES_AVAILABLE] = 0;\n            this.controlSAB[CONTROL.WRITE_INDEX] = 0;\n            return;\n        }\n        if (this.controlSAB == undefined) {\n            return;\n        }\n        var framesAvailable = this.controlSAB[CONTROL.FRAMES_AVAILABLE];\n        var lock = this.controlSAB[CONTROL.LOCK];\n        if (lock == 0 && framesAvailable > 0) {\n            var data = this.dataSAB.subarray(0, framesAvailable);\n            this.controlSAB[CONTROL.FRAMES_AVAILABLE] = 0;\n            this.controlSAB[CONTROL.WRITE_INDEX] = 0;\n            if (data.length > 0) {\n                var frames_1;\n                if (this.resampleRatio > 1) {\n                    frames_1 = this.downsample(data);\n                }\n                else {\n                    frames_1 = float32ToInt16(data);\n                }\n                this.websocket.send(frames_1);\n                // 16000 per second, 1000 in 100 ms\n                // save last 250 ms\n                if (this.lastFramesSent.length > 1024 * 4) {\n                    this.lastFramesSent = frames_1;\n                }\n                else {\n                    var concat = new Int16Array(this.lastFramesSent.length + frames_1.length);\n                    concat.set(this.lastFramesSent);\n                    concat.set(frames_1, this.lastFramesSent.length);\n                    this.lastFramesSent = concat;\n                }\n            }\n        }\n    };\n    WebsocketClient.prototype.startContext = function (appId) {\n        if (!this.isOpen()) {\n            throw Error('Cant start context: websocket is inactive');\n        }\n        if (this.isContextStarted) {\n            console.log('Cant start context: it has been already started');\n            return;\n        }\n        this.isContextStarted = true;\n        this.isStartContextConfirmed = false;\n        if (appId !== undefined) {\n            this.websocket.send(JSON.stringify({ event: 'start', appId: appId }));\n        }\n        else {\n            this.websocket.send(JSON.stringify({ event: 'start' }));\n        }\n    };\n    WebsocketClient.prototype.stopContext = function () {\n        if (this.websocket == undefined) {\n            throw Error('Cant start context: websocket is undefined');\n        }\n        if (!this.isContextStarted) {\n            console.log('Cant stop context: it is not started');\n            return;\n        }\n        this.isContextStarted = false;\n        this.isStartContextConfirmed = false;\n        var StopEventJSON = JSON.stringify({ event: 'stop' });\n        this.websocket.send(StopEventJSON);\n    };\n    WebsocketClient.prototype.switchContext = function (newAppId) {\n        if (this.websocket == undefined) {\n            throw Error('Cant switch context: websocket is undefined');\n        }\n        if (!this.isContextStarted) {\n            console.log('Cant switch context: it is not started');\n            return;\n        }\n        if (newAppId == undefined) {\n            console.log('Cant switch context: new app id is undefined');\n            return;\n        }\n        this.isStartContextConfirmed = false;\n        var StopEventJSON = JSON.stringify({ event: 'stop' });\n        this.websocket.send(StopEventJSON);\n        this.shouldResendLastFramesSent = true;\n        this.websocket.send(JSON.stringify({ event: 'start', appId: newAppId }));\n    };\n    WebsocketClient.prototype.closeWebsocket = function () {\n        if (this.websocket == null) {\n            throw Error('Websocket is not open');\n        }\n        this.websocket.removeEventListener('open', this.onWebsocketOpen);\n        this.websocket.removeEventListener('message', this.onWebsocketMessage);\n        this.websocket.removeEventListener('error', this.onWebsocketError);\n        this.websocket.removeEventListener('close', this.onWebsocketClose);\n        this.websocket.close();\n    };\n    WebsocketClient.prototype.downsample = function (input) {\n        var inputBuffer = new Float32Array(this.buffer.length + input.length);\n        inputBuffer.set(this.buffer, 0);\n        inputBuffer.set(input, this.buffer.length);\n        var outputLength = Math.ceil((inputBuffer.length - this.filter.length) / this.resampleRatio);\n        var outputBuffer = new Int16Array(outputLength);\n        for (var i = 0; i < outputLength; i++) {\n            var offset = Math.round(this.resampleRatio * i);\n            var val = 0.0;\n            for (var j = 0; j < this.filter.length; j++) {\n                val += inputBuffer[offset + j] * this.filter[j];\n            }\n            outputBuffer[i] = val * (val < 0 ? 0x8000 : 0x7fff);\n        }\n        var remainingOffset = Math.round(this.resampleRatio * outputLength);\n        if (remainingOffset < inputBuffer.length) {\n            this.buffer = inputBuffer.subarray(remainingOffset);\n        }\n        else {\n            this.buffer = new Float32Array(0);\n        }\n        return outputBuffer;\n    };\n    return WebsocketClient;\n}());\nvar ctx = self;\nvar websocketClient = new WebsocketClient(ctx);\nctx.onmessage = function (e) {\n    switch (e.data.type) {\n        case 'INIT':\n            websocketClient.init(e.data.apiUrl, e.data.authToken, e.data.targetSampleRate, e.data.debug);\n            break;\n        case 'SET_SOURSE_SAMPLE_RATE':\n            websocketClient.setSourceSampleRate(e.data.sourceSampleRate);\n            break;\n        case 'SET_SHARED_ARRAY_BUFFERS':\n            websocketClient.setSharedArrayBuffers(e.data.controlSAB, e.data.dataSAB);\n            break;\n        case 'CLOSE':\n            websocketClient.closeWebsocket();\n            break;\n        case 'START_CONTEXT':\n            websocketClient.startContext(e.data.appId);\n            break;\n        case 'SWITCH_CONTEXT':\n            websocketClient.switchContext(e.data.appId);\n            break;\n        case 'STOP_CONTEXT':\n            websocketClient.stopContext();\n            break;\n        case 'AUDIO':\n            websocketClient.sendAudio(e.data.payload);\n            break;\n        default:\n            console.log('WORKER', e);\n    }\n};\nfunction float32ToInt16(buffer) {\n    var buf = new Int16Array(buffer.length);\n    for (var l = 0; l < buffer.length; l++) {\n        buf[l] = buffer[l] * (buffer[l] < 0 ? 0x8000 : 0x7fff);\n    }\n    return buf;\n}\nfunction generateFilter(sourceSampleRate, targetSampleRate, length) {\n    if (length % 2 === 0) {\n        throw Error('Filter length must be odd');\n    }\n    var cutoff = targetSampleRate / 2;\n    var filter = new Float32Array(length);\n    var sum = 0;\n    for (var i = 0; i < length; i++) {\n        var x = sinc(((2 * cutoff) / sourceSampleRate) * (i - (length - 1) / 2));\n        sum += x;\n        filter[i] = x;\n    }\n    for (var i = 0; i < length; i++) {\n        filter[i] = filter[i] / sum;\n    }\n    return filter;\n}\nfunction sinc(x) {\n    if (x === 0.0) {\n        return 1.0;\n    }\n    var piX = Math.PI * x;\n    return Math.sin(piX) / piX;\n}\n"},"__esModule",{value:!0}),xn=he&&he.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};const Tn=(he&&he.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(Nn);var An=class{constructor(){this.startCbs=[],this.stopCbs=[],this.onResponseCb=()=>{},this.onCloseCb=()=>{},this.onWebsocketMessage=e=>{const t=e.data;switch(t.type){case kn.WebsocketResponseType.Opened:null!=this.resolveInitialization&&this.resolveInitialization();break;case kn.WebsocketResponseType.SourceSampleRateSetSuccess:null!=this.resolveSourceSampleRateSet&&this.resolveSourceSampleRateSet();break;case kn.WebsocketResponseType.Started:this.startCbs.forEach((e=>{try{e(void 0,t.audio_context)}catch(e){console.error('[SpeechlyClient] Error while invoking "onStart" callback:',e)}})),this.startCbs.length=0;break;case kn.WebsocketResponseType.Stopped:this.stopCbs.forEach((e=>{try{e(void 0,t.audio_context)}catch(e){console.error('[SpeechlyClient] Error while invoking "onStop" callback:',e)}})),this.stopCbs.length=0;break;default:this.onResponseCb(t)}};const e=new Blob([Tn.default],{type:"text/javascript"}),t=window.URL.createObjectURL(e);this.worker=new Worker(t),this.worker.addEventListener("message",this.onWebsocketMessage)}onResponse(e){this.onResponseCb=e}onClose(e){this.onCloseCb=e}initialize(e,t,n,i){return xn(this,void 0,void 0,(function*(){return this.worker.postMessage({type:"INIT",apiUrl:e,authToken:t,targetSampleRate:n,debug:i}),new Promise((e=>{this.resolveInitialization=e}))}))}setSourceSampleRate(e){return xn(this,void 0,void 0,(function*(){return this.worker.postMessage({type:"SET_SOURSE_SAMPLE_RATE",sourceSampleRate:e}),new Promise((e=>{this.resolveSourceSampleRateSet=e}))}))}close(){return xn(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.worker.postMessage({type:"CLOSE",code:1e3,message:"Client has ended the session"}),e()}))}))}startContext(e){return xn(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{this.startCbs.push(((e,i)=>{void 0!==e?n(e):t(i)})),null!=e?this.worker.postMessage({type:"START_CONTEXT",appId:e}):this.worker.postMessage({type:"START_CONTEXT"})}))}))}stopContext(){return xn(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.stopCbs.push(((n,i)=>{void 0!==n?t(n):e(i)})),this.worker.postMessage({type:"STOP_CONTEXT"})}))}))}switchContext(e){return xn(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{this.startCbs.push(((e,i)=>{void 0!==e?n(e):t(i)})),this.worker.postMessage({type:"SWITCH_CONTEXT",appId:e})}))}))}postMessage(e){this.worker.postMessage(e)}sendAudio(e){this.worker.postMessage({type:"AUDIO",payload:e})}},_n=Object.defineProperty({WebWorkerController:An},"__esModule",{value:!0}),En=pe((function(e,t){function n(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(_n),n(kn)}));var Rn=class{constructor(){this.storage=window.localStorage}get(e){return this.storage.getItem(e)}set(e,t){this.storage.setItem(e,t)}getOrSet(e,t){let n=this.storage.getItem(e);return null===n&&(n=t(),this.storage.setItem(e,n)),n}},In=Object.defineProperty({LocalStorage:Rn},"__esModule",{value:!0}),Mn=new Error("Current device does not support storage API"),$n=new Error("Requested key was not present in storage"),On=Object.defineProperty({ErrNoStorageSupport:Mn,ErrKeyNotFound:$n},"__esModule",{value:!0}),zn=pe((function(e,t){function n(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(In),n(On)}));var Bn=class{constructor(e,t){this.isFinalized=!1,this.words=[],this.entities=new Map,this.intent={intent:"",isFinal:!1},this.contextId=e,this.id=t}toSegment(){let e=0;const t=new Array(this.entities.size);return this.entities.forEach((n=>{t[e]=n,e++})),{id:this.id,contextId:this.contextId,isFinal:this.isFinalized,words:this.words,entities:t,intent:this.intent}}toString(){const e=this.toSegment(),t=e.words.filter((e=>e.value)).map((e=>({value:e.value,index:e.index}))),n=Object.assign(Object.assign({},e),{words:t});return JSON.stringify(n,null,2)}updateTranscript(e){return e.forEach((e=>{this.isFinalized&&!e.isFinal||(this.words[e.index]=e)})),this}updateEntities(e){return e.forEach((e=>{this.isFinalized&&!e.isFinal||this.entities.set(function(e){return`${e.startPosition.toString()}:${e.endPosition.toString()}`}(e),e)})),this}updateIntent(e){return this.isFinalized&&!e.isFinal||(this.intent=e),this}finalize(){return this.entities.forEach(((e,t)=>{e.isFinal||this.entities.delete(t)})),this.words=this.words.filter((e=>e.isFinal)),this.intent.isFinal||(this.intent.intent="",this.intent.isFinal=!0),this.isFinalized=!0,this}};var Pn=Object.defineProperty({SegmentState:Bn},"__esModule",{value:!0});var Ln=function(e){return e.words.map((({word:e,index:t,start_timestamp:n,end_timestamp:i})=>({value:e,index:t,startTimestamp:n,endTimestamp:i,isFinal:!1})))};var Fn=function(e){return{value:e.word,index:e.index,startTimestamp:e.start_timestamp,endTimestamp:e.end_timestamp,isFinal:!0}};var Dn=function(e){return e.entities.map((({entity:e,value:t,start_position:n,end_position:i})=>({type:e,value:t,startPosition:n,endPosition:i,isFinal:!1})))};var Wn=function(e){return{type:e.entity,value:e.value,startPosition:e.start_position,endPosition:e.end_position,isFinal:!0}};var jn=function(e,t){return{intent:e.intent,isFinal:t}},Un=Object.defineProperty({parseTentativeTranscript:Ln,parseTranscript:Fn,parseTentativeEntities:Dn,parseEntity:Wn,parseIntent:jn},"__esModule",{value:!0});function Gn(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var Kn=Gn;Gn.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts},Gn.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},Gn.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),n=this._timeouts.shift()}var i=this,a=setTimeout((function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout((function(){i._operationTimeoutCb(i._attempts)}),i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)}),n);return this._options.unref&&a.unref(),!0},Gn.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},Gn.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},Gn.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},Gn.prototype.start=Gn.prototype.try,Gn.prototype.errors=function(){return this._errors},Gn.prototype.attempts=function(){return this._attempts},Gn.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,i=0;i<this._errors.length;i++){var a=this._errors[i],o=a.message,r=(e[o]||0)+1;e[o]=r,r>=n&&(t=a,n=r)}return t};var Hn=pe((function(e,t){t.operation=function(e){var n=t.timeouts(e);return new Kn(n,{forever:e&&e.forever,unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],a=0;a<t.retries;a++)i.push(this.createTimeout(a,t));return e&&e.forever&&!i.length&&i.push(this.createTimeout(a,t)),i.sort((function(e,t){return e-t})),i},t.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,i=Math.round(n*t.minTimeout*Math.pow(t.factor,e));return i=Math.min(i,t.maxTimeout)},t.wrap=function(e,n,i){if(n instanceof Array&&(i=n,n=null),!i)for(var a in i=[],e)"function"==typeof e[a]&&i.push(a);for(var o=0;o<i.length;o++){var r=i[o],s=e[r];e[r]=function(i){var a=t.operation(n),o=Array.prototype.slice.call(arguments,1),r=o.pop();o.push((function(e){a.retry(e)||(e&&(arguments[0]=a.mainError()),r.apply(this,arguments))})),a.attempt((function(){i.apply(e,o)}))}.bind(e,s),e[r].options=n}}}));var Vn=function(e,t){return new Promise((function(n,i){var a=t||{};"randomize"in a||(a.randomize=!0);var o=Hn.operation(a);function r(e){i(e||new Error("Aborted"))}function s(e,t){e.bail?r(e):o.retry(e)?a.onRetry&&a.onRetry(e,t):i(o.mainError())}o.attempt((function(t){var i;try{i=e(r,t)}catch(e){return void s(e,t)}Promise.resolve(i).then(n).catch((function(e){s(e,t)}))}))}))},Jn=de(Pt),Zn=de(un),qn=he&&he.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))},Xn=he&&he.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};const Yn=Xn(Jn),Qn=Xn(Vn),ei="speechly-auth-token";var ti=class{constructor(e){var t,n,i,a,o,r,s,c,u,l,h,d;this.activeContexts=new Map,this.reconnectAttemptCount=5,this.reconnectMinDelay=1e3,this.contextStopDelay=250,this.state=fe.ClientState.Disconnected,this.stateChangeCb=()=>{},this.segmentChangeCb=()=>{},this.tentativeTranscriptCb=()=>{},this.tentativeEntitiesCb=()=>{},this.tentativeIntentCb=()=>{},this.transcriptCb=()=>{},this.entityCb=()=>{},this.intentCb=()=>{},this.handleWebsocketResponse=e=>{var t;this.debug&&console.log("[SpeechlyClient]","Received response",e);const{audio_context:n,segment_id:i,type:a}=e;let{data:o}=e;const r=this.activeContexts.get(n);if(void 0===r)return void console.warn("[SpeechlyClient]","Received response for non-existent context",n);let s=null!==(t=r.get(i))&&void 0!==t?t:new Pn.SegmentState(n,i);switch(a){case En.WebsocketResponseType.TentativeTranscript:o=o;const e=Un.parseTentativeTranscript(o);this.tentativeTranscriptCb(n,i,e,o.transcript),s=s.updateTranscript(e);break;case En.WebsocketResponseType.Transcript:o=o;const t=Un.parseTranscript(o);this.transcriptCb(n,i,t),s=s.updateTranscript([t]);break;case En.WebsocketResponseType.TentativeEntities:o=o;const a=Un.parseTentativeEntities(o);this.tentativeEntitiesCb(n,i,a),s=s.updateEntities(a);break;case En.WebsocketResponseType.Entity:o=o;const r=Un.parseEntity(o);this.entityCb(n,i,r),s=s.updateEntities([r]);break;case En.WebsocketResponseType.TentativeIntent:o=o;const c=Un.parseIntent(o,!1);this.tentativeIntentCb(n,i,c),s=s.updateIntent(c);break;case En.WebsocketResponseType.Intent:o=o;const u=Un.parseIntent(o,!0);this.intentCb(n,i,u),s=s.updateIntent(u);break;case En.WebsocketResponseType.SegmentEnd:s=s.finalize()}r.set(i,s),this.activeContexts.set(n,r),this.logSegments&&console.info(s.toString()),this.segmentChangeCb(s.toSegment())},this.handleWebsocketClosure=e=>{this.debug&&console.error("[SpeechlyClient]","Server connection closed",e),void 0!==this.deviceId?this.state!==fe.ClientState.Connecting&&this.state!==fe.ClientState.Failed&&(this.setState(fe.ClientState.Connecting),this.reconnectWebsocket(this.deviceId).then((()=>this.setState(fe.ClientState.Connected))).catch((()=>this.setState(fe.ClientState.Failed)))):this.setState(fe.ClientState.Failed)},this.sampleRate=null!==(t=e.sampleRate)&&void 0!==t?t:Cn.DefaultSampleRate;try{const e=window.navigator.mediaDevices.getSupportedConstraints();this.nativeResamplingSupported=!0===e.sampleRate}catch(e){this.nativeResamplingSupported=!1}const p=null!==(n=e.language)&&void 0!==n?n:"en-US";if(!Yn.default.validate(p))throw Error(`[SpeechlyClient] Invalid language "${p}"`);this.debug=null!==(i=e.debug)&&void 0!==i&&i,this.logSegments=null!==(a=e.logSegments)&&void 0!==a&&a,this.loginUrl=null!==(o=e.loginUrl)&&void 0!==o?o:"https://api.speechly.com/login",this.appId=null!==(r=e.appId)&&void 0!==r?r:void 0,this.projectId=null!==(s=e.projectId)&&void 0!==s?s:void 0;const f=function(e,t,n){const i=new URLSearchParams;return i.append("languageCode",t),i.append("sampleRate",n.toString()),`${e}?${i.toString()}`}(null!==(c=e.apiUrl)&&void 0!==c?c:"wss://api.speechly.com/ws/v1",p,null!==(u=e.sampleRate)&&void 0!==u?u:Cn.DefaultSampleRate);this.apiClient=null!==(l=e.apiClient)&&void 0!==l?l:new En.WebWorkerController,this.storage=null!==(h=e.storage)&&void 0!==h?h:new zn.LocalStorage,this.deviceId=this.storage.getOrSet("speechly-device-id",Zn.v4);const m=this.storage.get(ei);if(this.initializeApiClientPromise=new Promise((e=>{this.resolveInitialization=e})),null!=m&&hn.validateToken(m,this.projectId,this.appId,this.deviceId)?(this.authToken=m,this.connect(f)):hn.fetchToken(this.loginUrl,this.projectId,this.appId,this.deviceId).then((e=>{this.authToken=e,this.storage.set(ei,this.authToken),this.connect(f)})).catch((e=>{throw e})),void 0!==window.AudioContext)this.isWebkit=!1;else{if(void 0===window.webkitAudioContext)throw Cn.ErrDeviceNotSupported;this.isWebkit=!0}this.microphone=null!==(d=e.microphone)&&void 0!==d?d:new Cn.BrowserMicrophone(this.isWebkit,this.sampleRate,this.apiClient,this.debug),this.apiClient.onResponse(this.handleWebsocketResponse),this.apiClient.onClose(this.handleWebsocketClosure),window.SpeechlyClient=this}connect(e){null!=this.authToken&&this.apiClient.initialize(e,this.authToken,this.sampleRate,this.debug).then((()=>{null!=this.resolveInitialization&&this.resolveInitialization()})).catch((e=>{throw e}))}initialize(){return qn(this,void 0,void 0,(function*(){if(yield this.initializeApiClientPromise,this.state!==fe.ClientState.Disconnected)throw Error("Cannot initialize client - client is not in Disconnected state");this.setState(fe.ClientState.Connecting);try{if(this.isWebkit)void 0!==window.webkitAudioContext&&(this.audioContext=new window.webkitAudioContext);else{const e={};this.nativeResamplingSupported&&(e.sampleRate=this.sampleRate),this.audioContext=new window.AudioContext(e)}const e={video:!1};if(this.nativeResamplingSupported?e.audio={sampleRate:this.sampleRate}:e.audio=!0,null==this.audioContext)throw Cn.ErrDeviceNotSupported;this.isWebkit&&(yield this.audioContext.resume()),yield this.apiClient.setSourceSampleRate(this.audioContext.sampleRate),this.initializeMicrophonePromise=this.microphone.initialize(this.audioContext,e),yield this.initializeMicrophonePromise}catch(e){switch(e){case Cn.ErrDeviceNotSupported:this.setState(fe.ClientState.NoBrowserSupport);break;case Cn.ErrNoAudioConsent:this.setState(fe.ClientState.NoAudioConsent);break;default:this.setState(fe.ClientState.Failed)}throw e}this.setState(fe.ClientState.Connected)}))}close(){return qn(this,void 0,void 0,(function*(){const e=[];try{yield this.microphone.close()}catch(t){e.push(t.message)}try{yield this.apiClient.close()}catch(t){e.push(t.message)}if(this.activeContexts.clear(),this.setState(fe.ClientState.Disconnected),e.length>0)throw Error(e.join(","))}))}switchContext(e){return qn(this,void 0,void 0,(function*(){if(this.state===fe.ClientState.Recording){this.resolveStopContext=void 0;const t=yield this.apiClient.switchContext(e);this.activeContexts.set(t,new Map)}}))}startContext(e){return qn(this,void 0,void 0,(function*(){if(null!=this.resolveStopContext&&(this.resolveStopContext(),yield this.stoppedContextIdPromise),this.state===fe.ClientState.Disconnected||this.state===fe.ClientState.Connecting)throw Error("Cannot start context - client is not connected");this.setState(fe.ClientState.Starting);return yield this._startContext(e)}))}_startContext(e){return qn(this,void 0,void 0,(function*(){let t;try{t=null!=this.projectId?yield this.apiClient.startContext(e):yield this.apiClient.startContext()}catch(e){throw this.setState(fe.ClientState.Connected),e}return this.setState(fe.ClientState.Recording),this.microphone.unmute(),this.activeContexts.set(t,new Map),t}))}stopContext(){return qn(this,void 0,void 0,(function*(){if(this.state!==fe.ClientState.Recording&&this.state!==fe.ClientState.Starting)throw Error("Cannot stop context - client is not recording");this.setState(fe.ClientState.Stopping),this.stoppedContextIdPromise=new Promise((e=>{Promise.race([new Promise((e=>setTimeout(e,this.contextStopDelay))),new Promise((e=>{this.resolveStopContext=e}))]).then((()=>{this._stopContext().then((t=>{e(t)})).catch((e=>{throw e}))})).catch((e=>{throw e}))}));const e=yield this.stoppedContextIdPromise;return this.setState(fe.ClientState.Connected),this.activeContexts.delete(e),e}))}_stopContext(){return qn(this,void 0,void 0,(function*(){let e;this.microphone.mute();try{e=yield this.apiClient.stopContext()}catch(e){throw this.setState(fe.ClientState.Failed),e}return e}))}onStateChange(e){this.stateChangeCb=e}onSegmentChange(e){this.segmentChangeCb=e}onTentativeTranscript(e){this.tentativeTranscriptCb=e}onTranscript(e){this.transcriptCb=e}onTentativeEntities(e){this.tentativeEntitiesCb=e}onEntity(e){this.entityCb=e}onTentativeIntent(e){this.tentativeIntentCb=e}onIntent(e){this.intentCb=e}reconnectWebsocket(e){return qn(this,void 0,void 0,(function*(){return Qn.default(((e,t)=>qn(this,void 0,void 0,(function*(){this.debug&&console.log("[SpeechlyClient]","WebSocket reconnection attempt number:",t)}))),{retries:this.reconnectAttemptCount,minTimeout:this.reconnectMinDelay})}))}setState(e){this.state!==e&&(this.debug&&console.log("[SpeechlyClient]","State transition",be.stateToString(this.state),be.stateToString(e)),this.state=e,this.stateChangeCb(e))}};var ni,ii,ai,oi,ri=Object.defineProperty({Client:ti},"__esModule",{value:!0}),si=pe((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(fe),t.stateToString=be.stateToString,t.Client=ri.Client})),ci=pe((function(e,t){function n(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(si),n(vn),n(kn),n(On)}));function ui(t){let n,i,a,o,r,s,c,u;return{c(){n=w("svg"),i=w("defs"),a=w("linearGradient"),o=w("stop"),r=w("stop"),s=w("g"),c=w("path"),u=w("path"),x(o,"stop-color","var(--gradient-stop1)"),x(o,"offset","0%"),x(r,"stop-color","var(--gradient-stop2)"),x(r,"offset","100%"),x(a,"x1","50%"),x(a,"y1","0%"),x(a,"x2","50%"),x(a,"y2","100%"),x(a,"id","a"),x(c,"d","M46 3.119c23.683 0 42.881 19.198 42.881 42.881S69.683 88.881 46 88.881 3.119 69.683 3.119 46 22.317 3.119 46 3.119z"),x(c,"fill","#FFF"),x(u,"d","M46 0C20.595 0 0 20.595 0 46s20.595 46 46 46 46-20.595 46-46S71.405 0 46 0zm0 3.119c23.683 0 42.881 19.198 42.881 42.881S69.683 88.881 46 88.881 3.119 69.683 3.119 46 22.317 3.119 46 3.119z"),x(u,"fill","url(#a)"),x(s,"fill","none"),x(s,"fillrule","nonzero"),x(n,"class","buttonFrameEl"),x(n,"viewBox","0 0 92 92"),x(n,"xmlns","http://www.w3.org/2000/svg"),A(n,"position","absolute"),A(n,"width","100%"),A(n,"height","100%"),A(n,"pointer-events","none"),A(n,"user-select","none"),A(n,"transform","rotate(var(--fx-rotation))")},m(e,t){b(e,n,t),g(n,i),g(i,a),g(a,o),g(a,r),g(n,s),g(s,c),g(s,u)},p:e,i:e,o:e,d(e){e&&S(n)}}}class li extends le{constructor(e){super(),ce(this,e,null,ui,r,{})}}!function(e){e.Failed="Failed",e.NoBrowserSupport="NoBrowserSupport",e.NoAudioConsent="NoAudioConsent",e.Idle="Idle",e.Connecting="Connecting",e.Ready="Ready",e.Recording="Recording",e.Loading="Loading"}(ni||(ni={})),function(e){e.Poweron="poweron",e.Mic="mic",e.Error="error",e.Denied="denied"}(ii||(ii={})),function(e){e.Hold="hold",e.Click="click",e.Noninteractive="noninteractive"}(ai||(ai={})),function(e){e.None="none",e.Connecting="connecting",e.Busy="busy"}(oi||(oi={}));const hi={[fe.ClientState.Disconnected]:{icon:ii.Poweron,behaviour:ai.Click,effect:oi.None},[fe.ClientState.Disconnecting]:{icon:ii.Poweron,behaviour:ai.Noninteractive,effect:oi.Connecting},[fe.ClientState.Connecting]:{icon:ii.Poweron,behaviour:ai.Noninteractive,effect:oi.Connecting},[fe.ClientState.Connected]:{icon:ii.Mic,behaviour:ai.Hold,effect:oi.None},[fe.ClientState.Starting]:{icon:ii.Mic,behaviour:ai.Hold,effect:oi.Connecting},[fe.ClientState.Recording]:{icon:ii.Mic,behaviour:ai.Hold,effect:oi.None},[fe.ClientState.Stopping]:{icon:ii.Mic,behaviour:ai.Noninteractive,effect:oi.Busy},[fe.ClientState.Failed]:{icon:ii.Error,behaviour:ai.Click,effect:oi.None},[fe.ClientState.NoBrowserSupport]:{icon:ii.Error,behaviour:ai.Click,effect:oi.None},[fe.ClientState.NoAudioConsent]:{icon:ii.Denied,behaviour:ai.Click,effect:oi.None},[ni.Idle]:{icon:ii.Poweron,behaviour:ai.Click,effect:oi.None},[ni.Connecting]:{icon:ii.Poweron,behaviour:ai.Noninteractive,effect:oi.Connecting},[ni.Ready]:{icon:ii.Mic,behaviour:ai.Hold,effect:oi.None},[ni.Recording]:{icon:ii.Mic,behaviour:ai.Hold,effect:oi.None},[ni.Loading]:{icon:ii.Mic,behaviour:ai.Noninteractive,effect:oi.Busy},[ni.Failed]:{icon:ii.Error,behaviour:ai.Click,effect:oi.None},[ni.NoBrowserSupport]:{icon:ii.Error,behaviour:ai.Click,effect:oi.None},[ni.NoAudioConsent]:{icon:ii.Denied,behaviour:ai.Click,effect:oi.None}};function di(e){let t,n,i,a;return{c(){t=w("svg"),n=w("g"),i=w("path"),a=w("rect"),x(i,"d","M42 26h4v4c0 9.265-7 16.895-16 17.89V55h-4v-7.11c-8.892-.982-15.833-8.444-15.997-17.56L10 30v-4h4v4c0 7.732 6.268 14 14 14 7.628 0 13.83-6.1 13.997-13.687L42 30v-4z"),x(a,"x","20"),x(a,"y","1"),x(a,"width","16"),x(a,"height","37"),x(a,"rx","8"),x(n,"fill","#000"),x(n,"fill-rule","evenodd"),x(t,"class","buttonIconEl"),x(t,"viewBox","0 0 56 56"),x(t,"xmlns","http://www.w3.org/2000/svg")},m(e,o){b(e,t,o),g(t,n),g(n,i),g(n,a)},d(e){e&&S(t)}}}function pi(e){let t,n,i,a;return{c(){t=w("svg"),n=w("g"),i=w("path"),a=w("path"),x(i,"d","M42 26h4v4c0 9.265-7 16.895-16 17.89V55h-4v-7.11c-8.892-.982-15.833-8.444-15.997-17.56L10 30v-4h4v4c0 7.732 6.268 14 14 14 7.628 0 13.83-6.1 13.997-13.687L42 30v-4z"),x(i,"fill-rule","nonzero"),x(a,"d","M37 13.081V31a8 8 0 11-16 0v-1.919l16-16zM26 1a8 8 0 018 8v1.319L18 26.318V9a8 8 0 018-8zM37.969 7.932l3.74-7.35 3.018 2.625zM39.654 10.608l7.531-3.359.695 3.94z"),x(n,"fill","#000"),x(n,"fill-rule","evenodd"),x(t,"class","buttonIconEl"),x(t,"viewBox","0 0 56 56"),x(t,"xmlns","http://www.w3.org/2000/svg")},m(e,o){b(e,t,o),g(t,n),g(n,i),g(n,a)},d(e){e&&S(t)}}}function fi(e){let t,n,i,a;return{c(){t=w("svg"),n=w("g"),i=w("path"),a=w("path"),x(i,"d","M36 14.828V30a8 8 0 01-15.961.79l15.96-15.962zM28 1a8 8 0 018 8v.172L20 25.173V9a8 8 0 018-8z"),x(a,"d","M42 26h4v4c0 9.265-7 16.895-16 17.89V55h-4v-7.11c-8.892-.982-15.833-8.444-15.997-17.56L10 30v-4h4v4c0 7.732 6.268 14 14 14 7.628 0 13.83-6.1 13.997-13.687L42 30v-4z"),x(n,"fill","#000"),x(n,"fill-rule","nonzero"),x(t,"class","buttonIconEl"),x(t,"viewBox","0 0 56 56"),x(t,"xmlns","http://www.w3.org/2000/svg")},m(e,o){b(e,t,o),g(t,n),g(n,i),g(n,a)},d(e){e&&S(t)}}}function mi(e){let t,n,i,a;return{c(){t=w("svg"),n=w("g"),i=w("path"),a=w("rect"),x(i,"d","M52 28c0 13.255-10.745 24-24 24S4 41.255 4 28c0-8.921 4.867-16.705 12.091-20.842l1.984 3.474C12.055 14.08 8 20.566 8 28c0 11.046 8.954 20 20 20s20-8.954 20-20c0-7.434-4.056-13.92-10.075-17.368L39.91 7.16C47.133 11.296 52 19.079 52 28z"),x(i,"fill-rule","nonzero"),x(a,"x","24"),x(a,"y","1"),x(a,"width","8"),x(a,"height","23"),x(a,"rx","4"),x(n,"fill","#000"),x(n,"fill-rule","evenodd"),x(t,"class","buttonIconEl"),x(t,"viewBox","0 0 56 56"),x(t,"xmlns","http://www.w3.org/2000/svg")},m(e,o){b(e,t,o),g(t,n),g(n,i),g(n,a)},d(e){e&&S(t)}}}function vi(t){let n,i,a,o,r=t[0]===ii.Mic&&di(),s=t[0]===ii.Error&&pi(),c=t[0]===ii.Denied&&fi(),u=t[0]===ii.Poweron&&mi();return{c(){n=y("div"),r&&r.c(),i=k(),s&&s.c(),a=k(),c&&c.c(),o=k(),u&&u.c(),A(n,"position","absolute"),A(n,"width","60%"),A(n,"height","60%"),A(n,"top","50%"),A(n,"left","50%"),A(n,"transform","translate(-50%, -50%)"),A(n,"pointer-events","none"),A(n,"transition","0.25s"),A(n,"opacity","var(--icon-opacity)")},m(e,t){b(e,n,t),r&&r.m(n,null),g(n,i),s&&s.m(n,null),g(n,a),c&&c.m(n,null),g(n,o),u&&u.m(n,null)},p(e,[t]){e[0]===ii.Mic?r||(r=di(),r.c(),r.m(n,i)):r&&(r.d(1),r=null),e[0]===ii.Error?s||(s=pi(),s.c(),s.m(n,a)):s&&(s.d(1),s=null),e[0]===ii.Denied?c||(c=fi(),c.c(),c.m(n,o)):c&&(c.d(1),c=null),e[0]===ii.Poweron?u||(u=mi(),u.c(),u.m(n,null)):u&&(u.d(1),u=null)},i:e,o:e,d(e){e&&S(n),r&&r.d(),s&&s.d(),c&&c.d(),u&&u.d()}}}function gi(e,t,n){let{icon:i=ii.Mic}=t;return e.$$set=e=>{"icon"in e&&n(0,i=e.icon)},[i]}class bi extends le{constructor(e){super(),ce(this,e,gi,vi,r,{icon:0})}}function Si(t){let n,i,a,o,r,s,c,u;return{c(){n=w("svg"),i=w("defs"),a=w("linearGradient"),o=w("stop"),r=w("stop"),s=w("filter"),c=w("feGaussianBlur"),u=w("circle"),x(o,"stop-color","var(--gradient-stop1)"),x(o,"offset","0%"),x(r,"stop-color","var(--gradient-stop2)"),x(r,"offset","100%"),x(a,"x1","50%"),x(a,"y1","10%"),x(a,"x2","50%"),x(a,"y2","100%"),x(a,"id","a"),x(c,"stdDeviation","18"),x(c,"in","SourceGraphic"),x(s,"x","-35%"),x(s,"y","-35%"),x(s,"width","170%"),x(s,"height","170%"),x(s,"filterUnits","objectBoundingBox"),x(s,"id","b"),x(u,"filter","url(#b)"),x(u,"cx","124"),x(u,"cy","124"),x(u,"r","79"),x(u,"fill","url(#a)"),x(u,"fillrule","evenodd"),x(n,"viewBox","0 0 246 246"),x(n,"xmlns","http://www.w3.org/2000/svg"),A(n,"top","-75%"),A(n,"left","-75%"),A(n,"height","250%"),A(n,"width","250%"),A(n,"position","absolute"),A(n,"pointer-events","none"),A(n,"opacity","var(--fx-opacity)"),A(n,"transform","rotate(var(--fx-rotation))")},m(e,t){b(e,n,t),g(n,i),g(i,a),g(a,o),g(a,r),g(i,s),g(s,c),g(n,u)},p:e,i:e,o:e,d(e){e&&S(n)}}}class yi extends le{constructor(e){super(),ce(this,e,null,Si,r,{})}}const{window:wi}=ie;function Ci(t){let n,i,o,r,s,c,u,l,h,d,p,f;return o=new yi({}),s=new li({}),u=new bi({props:{icon:t[7].icon}}),{c(){n=y("main"),i=y("div"),ae(o.$$.fragment),r=k(),ae(s.$$.fragment),c=k(),ae(u.$$.fragment),l=k(),h=y("slot"),this.c=e,x(i,"class","ButtonComponents"),A(i,"transform","scale("+t[4][1]+")"),A(n,"width",t[0]),A(n,"height",t[0]),A(n,"--gradient-stop1",t[1]),A(n,"--gradient-stop2",t[2]),A(n,"--fx-rotation",t[3][1]+"deg"),A(n,"--fx-opacity",t[6][1]),A(n,"--icon-opacity",t[5][1])},m(e,a){b(e,n,a),g(n,i),oe(o,i,null),g(i,r),oe(s,i,null),g(i,c),oe(u,i,null),g(n,l),g(n,h),d=!0,p||(f=[N(wi,"mouseup",t[9]),N(wi,"keydown",t[10]),N(wi,"keyup",t[11]),N(n,"mousedown",t[8]),N(n,"touchstart",t[8]),N(n,"dragstart",t[8]),N(n,"mouseup",t[9]),N(n,"touchend",t[9],{passive:!0}),N(n,"dragend",t[9])],p=!0)},p(e,[t]){const a={};128&t&&(a.icon=e[7].icon),u.$set(a),(!d||16&t)&&A(i,"transform","scale("+e[4][1]+")"),(!d||1&t)&&A(n,"width",e[0]),(!d||1&t)&&A(n,"height",e[0]),(!d||2&t)&&A(n,"--gradient-stop1",e[1]),(!d||4&t)&&A(n,"--gradient-stop2",e[2]),(!d||8&t)&&A(n,"--fx-rotation",e[3][1]+"deg"),(!d||64&t)&&A(n,"--fx-opacity",e[6][1]),(!d||32&t)&&A(n,"--icon-opacity",e[5][1])},i(e){d||(ee(o.$$.fragment,e),ee(s.$$.fragment,e),ee(u.$$.fragment,e),d=!0)},o(e){te(o.$$.fragment,e),te(s.$$.fragment,e),te(u.$$.fragment,e),d=!1},d(e){e&&S(n),re(o),re(s),re(u),p=!1,a(f)}}}function ki(e,t,n){let i,{icon:a=ni.Idle}=t,{capturekey:o=" "}=t,{size:r="6rem"}=t,{gradientstop1:s="#15e8b5"}=t,{gradientstop2:c="#4fa1f9"}=t,{hide:u}=t;let l=!1,h=0,d=[0,0],p=[0,0],f=[1,1],m=[0,0],v=hi[a],g=null,b=0,S=0;const y=B(),w=(e,t)=>{y.dispatchEvent(new CustomEvent(e,{detail:t,composed:!0}))};P((()=>{n(4,p=[1,0]);let e=null;const t=()=>{b=S,S=(new Date).getTime();const a=S-(b||S);v.effect===oi.Connecting&&n(5,f[0]=.25*Math.cos(S/2500*Math.PI*2)+.25,f),v.effect===oi.Busy&&n(5,f[0]=.25*Math.cos(S/1e3*Math.PI*2)+.25,f),n(4,p=[p[0],N(p[1],i?p[0]:0,.2,a)]),n(5,f=[f[0],N(f[1],f[0],.08,a)]),n(6,m=[m[0],N(m[1],m[0],.08,a)]),n(3,d=[d[0]+2.5,N(d[1],d[0],.05,a)]),e=requestAnimationFrame(t)};return t(),()=>cancelAnimationFrame(e)}));const C=e=>{e.preventDefault(),e.stopPropagation(),i&&!l&&(n(16,l=!0),h=Date.now(),n(4,p[0]=1.35,p),n(6,m[0]=1,m),x(),v.behaviour===ai.Click&&(n(3,d[0]+=720,d),null===g&&(g=window.setTimeout((()=>{n(6,m[0]=0,m),g=null}),500))),y.onholdstart&&y.onholdstart(),w("holdstart"))},k=()=>{if(l){n(4,p[0]=1,p),n(6,m[0]=0,m),n(16,l=!1);const e={timeMs:Date.now()-h};x(),null!==g&&window.clearTimeout(g),y.onholdend&&y.onholdend(e),w("holdend",e)}},N=(e,t,n,i)=>e*(1-(n=Math.pow(n,1e3/60/i)))+t*n,x=(e=5)=>{void 0!==navigator.vibrate&&navigator.vibrate(e)};return e.$$set=e=>{"icon"in e&&n(12,a=e.icon),"capturekey"in e&&n(13,o=e.capturekey),"size"in e&&n(0,r=e.size),"gradientstop1"in e&&n(1,s=e.gradientstop1),"gradientstop2"in e&&n(2,c=e.gradientstop2),"hide"in e&&n(14,u=e.hide)},e.$$.update=()=>{16384&e.$$.dirty&&(i=void 0===u||"false"===u),69632&e.$$.dirty&&(l||(e=>{if(v!==e)switch(n(7,v=e),e.icon){case ii.Mic:case ii.Denied:case ii.Error:n(5,f[0]=1,f)}})(hi[a]))},[r,s,c,d,p,f,m,v,C,k,e=>{o&&(e.key===o&&(document.hasFocus()&&document.activeElement!==document.body&&document.activeElement!==document.documentElement&&document.activeElement||null||(e.repeat?(e.preventDefault(),e.stopPropagation()):C(e))))},e=>{e.key===o&&k()},a,o,u,()=>l,l]}class Ni extends ue{constructor(e){super(),this.shadowRoot.innerHTML="<style>main{position:relative;pointer-events:auto;cursor:pointer;border-radius:50%;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none !important;-webkit-user-select:none !important}.ButtonComponents{width:100%;height:100%}</style>",ce(this,{target:this.shadowRoot,props:E(this.attributes),customElement:!0},ki,Ci,s,{icon:12,capturekey:13,size:0,gradientstop1:1,gradientstop2:2,hide:14,isbuttonpressed:15}),e&&(e.target&&b(e.target,this,e.anchor),e.props&&(this.$set(e.props),V()))}static get observedAttributes(){return["icon","capturekey","size","gradientstop1","gradientstop2","hide","isbuttonpressed"]}get icon(){return this.$$.ctx[12]}set icon(e){this.$set({icon:e}),V()}get capturekey(){return this.$$.ctx[13]}set capturekey(e){this.$set({capturekey:e}),V()}get size(){return this.$$.ctx[0]}set size(e){this.$set({size:e}),V()}get gradientstop1(){return this.$$.ctx[1]}set gradientstop1(e){this.$set({gradientstop1:e}),V()}get gradientstop2(){return this.$$.ctx[2]}set gradientstop2(e){this.$set({gradientstop2:e}),V()}get hide(){return this.$$.ctx[14]}set hide(e){this.$set({hide:e}),V()}get isbuttonpressed(){return this.$$.ctx[15]}}function xi(n){let i,r,s,c,u,h,d,p,m,v;return{c(){i=y("div"),r=y("div"),r.innerHTML="<slot></slot>",s=k(),c=y("div"),u=k(),x(r,"class","CalloutDiv"),_(r,"useShadow",Ai),x(c,"class","ArrowDiv"),A(c,"--ax","50%"),A(c,"--ay","100%"),x(i,"class","CalloutContainerDiv")},m(e,t){b(e,i,t),g(i,r),g(i,s),g(i,c),g(i,u),p=!0,m||(v=[N(i,"mousedown",n[8]),N(i,"touchstart",n[8]),N(i,"dragstart",n[8])],m=!0)},p:e,i(a){p||(G((()=>{d&&d.end(1),h||(h=function(n,i,a){let r,s,c=i(n,a),u=!1,h=0;function d(){r&&O(n,r)}function p(){const{delay:i=0,duration:a=300,easing:o=t,tick:p=e,css:m}=c||ne;m&&(r=$(n,0,1,a,i,o,m,h++)),p(0,1);const v=l()+i,g=v+a;s&&s.abort(),u=!0,G((()=>X(n,!0,"start"))),s=f((e=>{if(u){if(e>=g)return p(1,0),X(n,!0,"end"),d(),u=!1;if(e>=v){const t=o((e-v)/a);p(t,1-t)}}return u}))}let m=!1;return{start(){m||(O(n),o(c)?(c=c(),q().then(p)):p())},invalidate(){m=!1},end(){u&&(d(),u=!1)}}}(i,n[7],{})),h.start()})),p=!0)},o(r){h&&h.invalidate(),d=function(n,i,r){let s,c=i(n,r),u=!0;const h=Q;function d(){const{delay:i=0,duration:o=300,easing:r=t,tick:d=e,css:p}=c||ne;p&&(s=$(n,1,0,o,i,r,p));const m=l()+i,v=m+o;G((()=>X(n,!1,"start"))),f((e=>{if(u){if(e>=v)return d(0,1),X(n,!1,"end"),--h.r||a(h.c),!1;if(e>=m){const t=r((e-m)/o);d(1-t,t)}}return u}))}return h.r+=1,o(c)?q().then((()=>{c=c(),d()})):d(),{end(e){e&&c.tick&&c.tick(1,0),u&&(s&&O(n,s),u=!1)}}}(i,n[7],{}),p=!1},d(e){e&&S(i),e&&d&&d.end(),m=!1,a(v)}}}function Ti(t){let n,i,o,r,s=t[3]&&xi(t);return{c(){n=y("main"),s&&s.c(),i=k(),o=y("link"),this.c=e,A(n,"--ax",t[4].x),A(n,"--ay",t[4].y),A(n,"--halign",t[5].x),A(n,"--valign",t[5].y),A(n,"--borderradius",_i),A(n,"--arrowpad",`${t[6].value}${t[6].unit}`),A(n,"--textcolor",t[1]),A(n,"--backgroundcolor",t[2]),A(n,"--size",`${t[6].value*Math.sqrt(2)}${t[6].unit}`),A(n,"--fontsize",t[0]),A(n,"--offsetx","0rem"),A(n,"--offsety",`${t[6].value}${t[6].unit}`),x(o,"href","https://fonts.googleapis.com/css2?family=Saira+Condensed:wght@700&display=swap"),x(o,"rel","stylesheet")},m(e,t){b(e,n,t),s&&s.m(n,null),b(e,i,t),g(document.head,o),r=!0},p(e,[t]){e[3]?s?(s.p(e,t),8&t&&ee(s,1)):(s=xi(e),s.c(),ee(s,1),s.m(n,null)):s&&(Q={r:0,c:[],p:Q},te(s,1,1,(()=>{s=null})),Q.r||a(Q.c),Q=Q.p),(!r||2&t)&&A(n,"--textcolor",e[1]),(!r||4&t)&&A(n,"--backgroundcolor",e[2]),(!r||1&t)&&A(n,"--fontsize",e[0])},i(e){r||(ee(s),r=!0)},o(e){te(s),r=!1},d(e){e&&S(n),s&&s.d(),e&&S(i),S(o)}}}customElements.get("holdable-button")?console.warn("Skipping re-defining customElement holdable-button"):customElements.define("holdable-button",Ni);let Ai=!1,_i="0rem";function Ei(e,t,n){let{show:i}=t,{showtime:a=1e4}=t,{fontsize:o="1.2rem"}=t,{textcolor:r="#ffffff"}=t,{backgroundcolor:s="#202020"}=t,c=null,u=!1;const l=(h=(e,{duration:t=250})=>({duration:t,css:e=>`\n          clip-path: circle(${100*e}% at center);\n        `}),function(e,t){if(!e.hasOwnProperty("ownerDocument")){Object.defineProperty(e,"ownerDocument",{get:function(){return e.parentElement}});let t=e;for(;t.parentElement;)t=t.parentElement;e.parentElement.head=t}return h(e,t)});var h;return e.$$set=e=>{"show"in e&&n(9,i=e.show),"showtime"in e&&n(10,a=e.showtime),"fontsize"in e&&n(0,o=e.fontsize),"textcolor"in e&&n(1,r=e.textcolor),"backgroundcolor"in e&&n(2,s=e.backgroundcolor)},e.$$.update=()=>{512&e.$$.dirty&&(e=>{null!==c&&(window.clearTimeout(c),c=null),void 0!==e&&"false"!==e?c=window.setTimeout((()=>{n(3,u=!0),c=null,a>0&&(c=window.setTimeout((()=>{n(3,u=!1),c=null}),a))}),500):n(3,u=!1)})(i)},[o,r,s,u,{x:"50%",y:"10%"},{x:"50%",y:"100%"},{value:.55,unit:"rem"},l,e=>{e.preventDefault(),e.stopPropagation(),n(3,u=!1)},i,a]}class Ri extends ue{constructor(e){super(),this.shadowRoot.innerHTML="<style>main{margin:0;padding:0}.CalloutContainerDiv{position:absolute;left:var(--ax);top:var(--ay);transform:translate(calc(-1 * var(--halign)), calc(-1 * var(--valign)));padding:var(--arrowpad);z-index:10;pointer-events:auto}.CalloutDiv{position:relative;box-sizing:border-box;min-width:8rem;border-radius:var(--borderradius);padding:0.50rem 1rem;background-color:var(--backgroundcolor);text-align:center;user-select:none;z-index:10;color:var(--textcolor);font-family:'Saira Condensed', sans-serif;font-size:var(--fontsize);line-height:120%;text-transform:uppercase}.useShadow{box-shadow:0 0.2rem 0.5rem #00000040}.ArrowDiv{position:absolute;left:calc(var(--ax) - var(--offsetx));top:calc(var(--ay) - var(--offsety));transform:translate(-50%, -50%) rotate(45deg);width:var(--size);height:var(--size);background-color:var(--backgroundcolor);z-index:10}.ArrowShadowDiv{position:absolute;left:calc(var(--ax) - var(--offsetx));top:calc(var(--ay) - var(--offsety));transform:translate(-50%, -50%) rotate(45deg);width:var(--size);height:var(--size);background-color:var(--backgroundcolor);background-color:#00000000;box-shadow:0 0.2rem 0.5rem #00000040;z-index:9}</style>",ce(this,{target:this.shadowRoot,props:E(this.attributes),customElement:!0},Ei,Ti,s,{show:9,showtime:10,fontsize:0,textcolor:1,backgroundcolor:2}),e&&(e.target&&b(e.target,this,e.anchor),e.props&&(this.$set(e.props),V()))}static get observedAttributes(){return["show","showtime","fontsize","textcolor","backgroundcolor"]}get show(){return this.$$.ctx[9]}set show(e){this.$set({show:e}),V()}get showtime(){return this.$$.ctx[10]}set showtime(e){this.$set({showtime:e}),V()}get fontsize(){return this.$$.ctx[0]}set fontsize(e){this.$set({fontsize:e}),V()}get textcolor(){return this.$$.ctx[1]}set textcolor(e){this.$set({textcolor:e}),V()}get backgroundcolor(){return this.$$.ctx[2]}set backgroundcolor(e){this.$set({backgroundcolor:e}),V()}}function Ii(t){let n,i,o,r,s,c;return{c(){n=y("holdable-button"),i=y("call-out"),o=C(t[13]),this.c=e,T(i,"fontsize",t[7]),T(i,"show",r=""!==t[13]&&t[12]&&!t[4]?"true":"false"),T(i,"showtime",t[8]),T(i,"textcolor",t[9]),T(i,"backgroundcolor",t[10]),T(n,"size",t[0]),T(n,"icon",t[11]),T(n,"capturekey",t[1]),T(n,"gradientstop1",t[2]),T(n,"gradientstop2",t[3]),T(n,"hide",t[4]),A(n,"--voffset",t[6]),A(n,"--size",t[0]),_(n,"placementBottom","bottom"===t[5])},m(e,a){b(e,n,a),g(n,i),g(i,o),s||(c=[N(n,"holdstart",t[14]),N(n,"holdend",t[15])],s=!0)},p(e,t){8192&t[0]&&function(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}(o,e[13]),128&t[0]&&T(i,"fontsize",e[7]),12304&t[0]&&r!==(r=""!==e[13]&&e[12]&&!e[4]?"true":"false")&&T(i,"show",r),256&t[0]&&T(i,"showtime",e[8]),512&t[0]&&T(i,"textcolor",e[9]),1024&t[0]&&T(i,"backgroundcolor",e[10]),1&t[0]&&T(n,"size",e[0]),2048&t[0]&&T(n,"icon",e[11]),2&t[0]&&T(n,"capturekey",e[1]),4&t[0]&&T(n,"gradientstop1",e[2]),8&t[0]&&T(n,"gradientstop2",e[3]),16&t[0]&&T(n,"hide",e[4]),64&t[0]&&A(n,"--voffset",e[6]),1&t[0]&&A(n,"--size",e[0]),32&t[0]&&_(n,"placementBottom","bottom"===e[5])},i:e,o:e,d(e){e&&S(n),s=!1,a(c)}}}customElements.get("call-out")?console.warn("Skipping re-defining customElement call-out"):customElements.define("call-out",Ri);function Mi(e,t,n){let i,a;var o=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,o){function r(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((i=i.apply(e,t||[])).next())}))};let r,s,{appid:c}=t,{size:u="6rem"}=t,{capturekey:l=" "}=t,{gradientstop1:h="#15e8b5"}=t,{gradientstop2:d="#4fa1f9"}=t,{poweron:p}=t,{hide:f}=t,{placement:m}=t,{voffset:v="3rem"}=t,{intro:g="Hold to talk"}=t,{hint:b="Hold to talk"}=t,{fontsize:S="1.2rem"}=t,{showtime:y=1e4}=t,{textcolor:w="#ffffff"}=t,{backgroundcolor:C="#202020"}=t,k=ci.ClientState.Disconnected,N=!1,x=!1,T=!1,A=null;const _=B(),E=(e,t)=>{_.dispatchEvent(new CustomEvent(e,{detail:t,composed:!0}))};P((()=>{T=!0,R(c)}));const R=e=>{T&&e&&!A&&(console.log("Create client with appId",e),A=new ci.Client({appId:e}),A.onStateChange(z),A.onSegmentChange((e=>{E("speechsegment",e),window.postMessage({type:"speechsegment",segment:e},"*")})),n(12,x=!0))},I=()=>{s&&n(11,k=s)},M=e=>!e||e===ci.ClientState.Disconnected,$=e=>e===ci.ClientState.Connected,O=e=>{switch(e){case ci.ClientState.Starting:case ci.ClientState.Recording:return!0;default:return!1}},z=e=>{switch(s=e,I(),e){case ci.ClientState.Failed:L(!1,"Failed");break;case ci.ClientState.NoBrowserSupport:L(!1,"NoBrowserSupport");break;case ci.ClientState.NoAudioConsent:L(!1,"NoAudioConsent");break;case ci.ClientState.Connected:L(!0,"Ready"),!a&&N&&$(s)&&A.startContext()}window.postMessage({type:"speechstate",state:e},"*")},L=(e,t)=>{void 0===r&&(r=e,E("initialized",{success:r,status:t}))};return e.$$set=e=>{"appid"in e&&n(16,c=e.appid),"size"in e&&n(0,u=e.size),"capturekey"in e&&n(1,l=e.capturekey),"gradientstop1"in e&&n(2,h=e.gradientstop1),"gradientstop2"in e&&n(3,d=e.gradientstop2),"poweron"in e&&n(17,p=e.poweron),"hide"in e&&n(4,f=e.hide),"placement"in e&&n(5,m=e.placement),"voffset"in e&&n(6,v=e.voffset),"intro"in e&&n(18,g=e.intro),"hint"in e&&n(19,b=e.hint),"fontsize"in e&&n(7,S=e.fontsize),"showtime"in e&&n(8,y=e.showtime),"textcolor"in e&&n(9,w=e.textcolor),"backgroundcolor"in e&&n(10,C=e.backgroundcolor)},e.$$.update=()=>{262144&e.$$.dirty[0]&&n(13,i=g),131072&e.$$.dirty[0]&&n(20,a=void 0!==p&&"false"!==p),1048576&e.$$.dirty[0]&&n(11,k=a?ci.ClientState.Disconnected:ci.ClientState.Connected),65536&e.$$.dirty[0]&&R(c)},[u,l,h,d,f,m,v,S,y,w,C,k,x,i,e=>{N=!0,n(12,x=!1),A&&(M(s)?c?o(void 0,void 0,void 0,(function*(){o(void 0,void 0,void 0,(function*(){try{console.log("Initializing...",A),E("starting"),yield A.initialize(),console.log("Initialized")}catch(e){console.log("Initialization failed",e),A=null}}))})):console.warn("No appid attribute specified. Speechly voice services are unavailable."):$(s)&&A.startContext()),window.postMessage({type:"holdstart"},"*")},e=>{const t=e.detail;!1!==r&&t.timeMs<600&&(n(13,i=b),n(12,x=!0)),N=!1,A&&O(s)&&A.stopContext(),I(),window.postMessage({type:"holdend"},"*")},c,p,g,b,a]}class $i extends ue{constructor(e){super(),this.shadowRoot.innerHTML="<style>.placementBottom{position:fixed;bottom:0;left:0;right:0;height:calc(var(--size) + var(--voffset));max-height:100vh;pointer-events:none;display:flex;flex-direction:row;justify-content:center;z-index:50}</style>",ce(this,{target:this.shadowRoot,props:E(this.attributes),customElement:!0},Mi,Ii,s,{appid:16,size:0,capturekey:1,gradientstop1:2,gradientstop2:3,poweron:17,hide:4,placement:5,voffset:6,intro:18,hint:19,fontsize:7,showtime:8,textcolor:9,backgroundcolor:10},[-1,-1]),e&&(e.target&&b(e.target,this,e.anchor),e.props&&(this.$set(e.props),V()))}static get observedAttributes(){return["appid","size","capturekey","gradientstop1","gradientstop2","poweron","hide","placement","voffset","intro","hint","fontsize","showtime","textcolor","backgroundcolor"]}get appid(){return this.$$.ctx[16]}set appid(e){this.$set({appid:e}),V()}get size(){return this.$$.ctx[0]}set size(e){this.$set({size:e}),V()}get capturekey(){return this.$$.ctx[1]}set capturekey(e){this.$set({capturekey:e}),V()}get gradientstop1(){return this.$$.ctx[2]}set gradientstop1(e){this.$set({gradientstop1:e}),V()}get gradientstop2(){return this.$$.ctx[3]}set gradientstop2(e){this.$set({gradientstop2:e}),V()}get poweron(){return this.$$.ctx[17]}set poweron(e){this.$set({poweron:e}),V()}get hide(){return this.$$.ctx[4]}set hide(e){this.$set({hide:e}),V()}get placement(){return this.$$.ctx[5]}set placement(e){this.$set({placement:e}),V()}get voffset(){return this.$$.ctx[6]}set voffset(e){this.$set({voffset:e}),V()}get intro(){return this.$$.ctx[18]}set intro(e){this.$set({intro:e}),V()}get hint(){return this.$$.ctx[19]}set hint(e){this.$set({hint:e}),V()}get fontsize(){return this.$$.ctx[7]}set fontsize(e){this.$set({fontsize:e}),V()}get showtime(){return this.$$.ctx[8]}set showtime(e){this.$set({showtime:e}),V()}get textcolor(){return this.$$.ctx[9]}set textcolor(e){this.$set({textcolor:e}),V()}get backgroundcolor(){return this.$$.ctx[10]}set backgroundcolor(e){this.$set({backgroundcolor:e}),V()}}customElements.get("push-to-talk-button")?console.warn("Skipping re-defining customElement push-to-talk-button"):customElements.define("push-to-talk-button",$i)}();
//# sourceMappingURL=push-to-talk-button.js.map
